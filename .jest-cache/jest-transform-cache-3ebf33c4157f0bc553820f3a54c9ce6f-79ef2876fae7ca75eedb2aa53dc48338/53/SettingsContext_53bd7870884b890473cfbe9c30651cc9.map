{"version":3,"sources":["D:\\Projects\\family-oriented\\src\\context\\SettingsContext.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { logger } from '@/utils/logger';\r\n\r\n// Define the structure for our global settings\r\nexport interface GlobalSettings {\r\n  // General settings\r\n  questionsPerSession: number;\r\n  \r\n  // Numbers game settings\r\n  numberRange: {\r\n    min: number;\r\n    max: number;\r\n  };\r\n  \r\n  // Fill in the blank settings\r\n  wordComplexity: 'easy' | 'medium' | 'hard';\r\n  \r\n  // Math settings\r\n  mathOperations: {\r\n    addition: boolean;\r\n    subtraction: boolean;\r\n  };\r\n  mathRange: {\r\n    min: number;\r\n    max: number;\r\n  };\r\n  showVisualAids: boolean;\r\n}\r\n\r\n// Default settings\r\nconst defaultSettings: GlobalSettings = {\r\n  questionsPerSession: 10,\r\n  numberRange: {\r\n    min: 1,\r\n    max: 20,\r\n  },\r\n  wordComplexity: 'easy',\r\n  mathOperations: {\r\n    addition: true,\r\n    subtraction: true,\r\n  },\r\n  mathRange: {\r\n    min: 1,\r\n    max: 10,\r\n  },\r\n  showVisualAids: true,\r\n};\r\n\r\n// Create the context\r\ntype SettingsContextType = {\r\n  settings: GlobalSettings;\r\n  updateSettings: (newSettings: Partial<GlobalSettings>) => void;\r\n  updateNumberRange: (min: number, max: number) => void;\r\n  updateMathRange: (min: number, max: number) => void;\r\n  resetSettings: () => void;\r\n};\r\n\r\nconst SettingsContext = createContext<SettingsContextType | undefined>(undefined);\r\n\r\n// Provider component\r\nexport function SettingsProvider({ children }: { children: ReactNode }) {\r\n  // Initialize state with default settings or from localStorage\r\n  const [settings, setSettings] = useState<GlobalSettings>(() => {\r\n    if (typeof window !== 'undefined') {\r\n      try {\r\n        const savedSettings = localStorage.getItem('globalGameSettings');\r\n        if (savedSettings) {\r\n          const parsedSettings = JSON.parse(savedSettings);\r\n          \r\n          // Ensure all required properties exist by merging with defaults\r\n          return {\r\n            ...defaultSettings,\r\n            ...parsedSettings,\r\n            // Ensure nested objects are properly merged\r\n            numberRange: {\r\n              ...defaultSettings.numberRange,\r\n              ...(parsedSettings.numberRange || {})\r\n            },\r\n            mathOperations: {\r\n              ...defaultSettings.mathOperations,\r\n              ...(parsedSettings.mathOperations || {})\r\n            },\r\n            mathRange: {\r\n              ...defaultSettings.mathRange,\r\n              ...(parsedSettings.mathRange || {})\r\n            }\r\n          };\r\n        }\r\n      } catch (error) {\r\n        logger.error('Error loading settings from localStorage:', error);\r\n        // If there's an error, return defaults\r\n      }\r\n    }\r\n    return defaultSettings;\r\n  });\r\n\r\n  // Save settings to localStorage when they change\r\n  useEffect(() => {\r\n    if (typeof window !== 'undefined') {\r\n      try {\r\n        localStorage.setItem('globalGameSettings', JSON.stringify(settings));\r\n      } catch (error) {\r\n        logger.error('Error saving settings to localStorage:', error);\r\n      }\r\n    }\r\n  }, [settings]);\r\n\r\n  // Update specific settings\r\n  const updateSettings = (newSettings: Partial<GlobalSettings>) => {\r\n    setSettings(prev => {\r\n      // Handle nested objects carefully\r\n      const updated = { ...prev, ...newSettings };\r\n      \r\n      // Ensure numberRange is properly updated if provided\r\n      if (newSettings.numberRange) {\r\n        updated.numberRange = {\r\n          ...prev.numberRange,\r\n          ...newSettings.numberRange\r\n        };\r\n      }\r\n      \r\n      // Ensure mathRange is properly updated if provided\r\n      if (newSettings.mathRange) {\r\n        updated.mathRange = {\r\n          ...prev.mathRange,\r\n          ...newSettings.mathRange\r\n        };\r\n      }\r\n      \r\n      // Ensure mathOperations is properly updated if provided\r\n      if (newSettings.mathOperations) {\r\n        updated.mathOperations = {\r\n          ...prev.mathOperations,\r\n          ...newSettings.mathOperations\r\n        };\r\n      }\r\n      \r\n      return updated;\r\n    });\r\n  };\r\n\r\n  // Helper for updating number range\r\n  const updateNumberRange = (min: number, max: number) => {\r\n    setSettings(prev => ({\r\n      ...prev,\r\n      numberRange: { min, max },\r\n    }));\r\n  };\r\n\r\n  // Helper for updating math range\r\n  const updateMathRange = (min: number, max: number) => {\r\n    setSettings(prev => ({\r\n      ...prev,\r\n      mathRange: { min, max },\r\n    }));\r\n  };\r\n\r\n  // Reset to defaults\r\n  const resetSettings = () => {\r\n    setSettings(defaultSettings);\r\n  };\r\n\r\n  return (\r\n    <SettingsContext.Provider\r\n      value={{\r\n        settings,\r\n        updateSettings,\r\n        updateNumberRange,\r\n        updateMathRange,\r\n        resetSettings,\r\n      }}\r\n    >\r\n      {children}\r\n    </SettingsContext.Provider>\r\n  );\r\n}\r\n\r\n// Custom hook for using the settings context\r\nexport function useSettings() {\r\n  const context = useContext(SettingsContext);\r\n  if (context === undefined) {\r\n    throw new Error('useSettings must be used within a SettingsProvider');\r\n  }\r\n  return context;\r\n} "],"names":["SettingsProvider","useSettings","defaultSettings","questionsPerSession","numberRange","min","max","wordComplexity","mathOperations","addition","subtraction","mathRange","showVisualAids","SettingsContext","createContext","undefined","children","settings","setSettings","useState","window","savedSettings","localStorage","getItem","parsedSettings","JSON","parse","error","logger","useEffect","setItem","stringify","updateSettings","newSettings","prev","updated","updateNumberRange","updateMathRange","resetSettings","Provider","value","context","useContext","Error"],"mappings":"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"}
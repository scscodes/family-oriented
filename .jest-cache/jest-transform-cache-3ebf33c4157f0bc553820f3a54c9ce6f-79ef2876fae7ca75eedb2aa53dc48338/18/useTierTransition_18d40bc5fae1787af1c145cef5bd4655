7dfbacea32fc40e1f69f598fa699761c
/**
 * useTierTransition Hook
 * Provides tier transition functionality for subscription plan changes
 * Handles analysis, validation, and execution of tier changes
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "useTierTransition", {
    enumerable: true,
    get: function() {
        return useTierTransition;
    }
});
const _react = require("react");
const _UserContext = require("../context/UserContext");
const _useSubscription = require("./useSubscription");
const _subscriptionService = require("../utils/subscriptionService");
const _client = require("../lib/supabase/client");
const _logger = require("../utils/logger");
function useTierTransition() {
    const { org } = (0, _UserContext.useUser)();
    const { subscriptionPlan, tier, currentUsage } = (0, _useSubscription.useSubscription)();
    const [isLoading, setIsLoading] = (0, _react.useState)(false);
    const [error, setError] = (0, _react.useState)(null);
    const supabase = (0, _client.createClient)();
    // Current tier and available transitions
    const currentTier = tier;
    const { upgrades: availableUpgrades, downgrades: availableDowngrades } = (0, _react.useMemo)(()=>{
        if (!currentTier) return {
            upgrades: [],
            downgrades: []
        };
        return _subscriptionService.SubscriptionService.getAvailableTransitions(currentTier);
    }, [
        currentTier
    ]);
    // Get current usage data
    const getCurrentUsageData = (0, _react.useCallback)(async ()=>{
        if (!org) {
            return {
                avatarsCount: 0,
                collectionsCount: 0,
                sessionsThisMonth: 0,
                dataRetentionMonths: 12
            };
        }
        try {
            // Get avatar count
            const { data: avatars } = await supabase.from('avatars').select('id').eq('org_id', org.id);
            // Get collections count (simplified - would normally be per-avatar)
            const { data: collections } = await supabase.from('game_collections').select('id').in('avatar_id', (avatars || []).map((a)=>a.id));
            // Get sessions this month
            const startOfMonth = new Date();
            startOfMonth.setDate(1);
            startOfMonth.setHours(0, 0, 0, 0);
            const { data: sessions } = await supabase.from('game_sessions').select('id').eq('org_id', org.id).gte('created_at', startOfMonth.toISOString());
            return {
                avatarsCount: avatars?.length || 0,
                collectionsCount: collections?.length || 0,
                sessionsThisMonth: sessions?.length || 0,
                dataRetentionMonths: 12 // Default
            };
        } catch (err) {
            _logger.logger.error('Failed to get usage data:', err);
            return {
                avatarsCount: currentUsage.avatarsCount,
                collectionsCount: 0,
                sessionsThisMonth: 0,
                dataRetentionMonths: 12
            };
        }
    }, [
        org,
        supabase,
        currentUsage.avatarsCount
    ]);
    // Analyze transition impact
    const analyzeTransition = (0, _react.useCallback)(async (targetTier)=>{
        if (!currentTier || !subscriptionPlan) {
            throw new Error('No current subscription to analyze');
        }
        setIsLoading(true);
        setError(null);
        try {
            const usageData = await getCurrentUsageData();
            // Get basic analysis
            const analysis = _subscriptionService.SubscriptionService.analyzeTierTransition(currentTier, targetTier, usageData);
            // Get cost information
            const currentCost = parseFloat(subscriptionPlan.base_price.toString());
            const newCost = getTierPrice(targetTier);
            const monthlyDifference = newCost - currentCost;
            const proration = _subscriptionService.SubscriptionService.calculateProration(currentCost, newCost);
            return {
                fromTier: currentTier,
                toTier: targetTier,
                isUpgrade: analysis.isUpgrade,
                isDowngrade: analysis.isDowngrade,
                featureChanges: {
                    gained: analysis.featureChanges.gained,
                    lost: analysis.featureChanges.lost
                },
                usageImpact: {
                    overLimitItems: analysis.usageImpact.overLimitItems
                },
                costImpact: {
                    currentCost,
                    newCost,
                    monthlyDifference,
                    prorationAmount: proration.prorationAmount,
                    prorationDescription: proration.description
                },
                warnings: analysis.warnings,
                canTransition: analysis.canTransition
            };
        } catch (err) {
            const message = err instanceof Error ? err.message : 'Failed to analyze transition';
            setError(message);
            throw err;
        } finally{
            setIsLoading(false);
        }
    }, [
        currentTier,
        subscriptionPlan,
        getCurrentUsageData
    ]);
    // Execute tier transition
    const executeTransition = (0, _react.useCallback)(async (targetTier)=>{
        if (!org || !currentTier) {
            throw new Error('No organization or current tier found');
        }
        setIsLoading(true);
        setError(null);
        try {
            // Validate transition first
            const usageData = await getCurrentUsageData();
            const validation = _subscriptionService.SubscriptionService.validateTierTransition(currentTier, targetTier, usageData);
            if (!validation.valid) {
                throw new Error(`Transition not allowed: ${validation.reasons.join(', ')}`);
            }
            // Get new subscription plan
            const { data: newPlan, error: planError } = await supabase.from('subscription_plans').select('*').eq('tier', targetTier).eq('active', true).order('base_price', {
                ascending: true
            }).limit(1).single();
            if (planError) throw planError;
            // Update organization subscription
            const { error: updateError } = await supabase.from('organizations').update({
                subscription_plan_id: newPlan.id,
                updated_at: new Date().toISOString()
            }).eq('id', org.id);
            if (updateError) throw updateError;
            // Log the transition
            _logger.logger.info('Tier transition completed:', {
                orgId: org.id,
                fromTier: currentTier,
                toTier: targetTier,
                timestamp: new Date().toISOString()
            });
            const tierDisplayName = getTierDisplayName(targetTier);
            const action = _subscriptionService.SubscriptionService.analyzeTierTransition(currentTier, targetTier, usageData).isUpgrade ? 'upgraded' : 'changed';
            return {
                success: true,
                message: `Successfully ${action} to ${tierDisplayName}!`
            };
        } catch (err) {
            const message = err instanceof Error ? err.message : 'Failed to execute transition';
            setError(message);
            _logger.logger.error('Tier transition failed:', err);
            return {
                success: false,
                message
            };
        } finally{
            setIsLoading(false);
        }
    }, [
        org,
        currentTier,
        supabase,
        getCurrentUsageData
    ]);
    // Utility functions
    const getTierDisplayName = (0, _react.useCallback)((tier)=>{
        const tierNames = {
            personal: 'Personal Plan',
            professional: 'Professional Plan',
            enterprise: 'Enterprise Plan'
        };
        return tierNames[tier];
    }, []);
    const getTierPrice = (0, _react.useCallback)((tier)=>{
        const prices = {
            personal: 9.99,
            professional: 199.99,
            enterprise: 1499.99
        };
        return prices[tier];
    }, []);
    const validateTransition = (0, _react.useCallback)((targetTier)=>{
        if (!currentTier) {
            return {
                valid: false,
                reasons: [
                    'No current tier found'
                ]
            };
        }
        // Use current usage data synchronously (fallback values)
        const usageData = {
            avatarsCount: currentUsage.avatarsCount,
            collectionsCount: 0,
            sessionsThisMonth: 0,
            dataRetentionMonths: 12
        };
        return _subscriptionService.SubscriptionService.validateTierTransition(currentTier, targetTier, usageData);
    }, [
        currentTier,
        currentUsage.avatarsCount
    ]);
    const clearError = (0, _react.useCallback)(()=>{
        setError(null);
    }, []);
    return {
        // Current state
        currentTier,
        availableUpgrades,
        availableDowngrades,
        isLoading,
        error,
        // Analysis
        analyzeTransition,
        // Execution
        executeTransition,
        // Utilities
        getTierDisplayName,
        getTierPrice,
        validateTransition,
        // State management
        clearError
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkQ6XFxQcm9qZWN0c1xcZmFtaWx5LW9yaWVudGVkXFxzcmNcXGhvb2tzXFx1c2VUaWVyVHJhbnNpdGlvbi50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIHVzZVRpZXJUcmFuc2l0aW9uIEhvb2tcclxuICogUHJvdmlkZXMgdGllciB0cmFuc2l0aW9uIGZ1bmN0aW9uYWxpdHkgZm9yIHN1YnNjcmlwdGlvbiBwbGFuIGNoYW5nZXNcclxuICogSGFuZGxlcyBhbmFseXNpcywgdmFsaWRhdGlvbiwgYW5kIGV4ZWN1dGlvbiBvZiB0aWVyIGNoYW5nZXNcclxuICovXHJcblxyXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2ssIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHVzZVVzZXIgfSBmcm9tICdAL2NvbnRleHQvVXNlckNvbnRleHQnO1xyXG5pbXBvcnQgeyB1c2VTdWJzY3JpcHRpb24gfSBmcm9tICdAL2hvb2tzL3VzZVN1YnNjcmlwdGlvbic7XHJcbmltcG9ydCB7IFxyXG4gIFN1YnNjcmlwdGlvblNlcnZpY2UsIFxyXG4gIHR5cGUgU3Vic2NyaXB0aW9uVGllcixcclxuICB0eXBlIFVzYWdlRGF0YSBcclxufSBmcm9tICdAL3V0aWxzL3N1YnNjcmlwdGlvblNlcnZpY2UnO1xyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9jbGllbnQnO1xyXG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRpZXJUcmFuc2l0aW9uQW5hbHlzaXMge1xyXG4gIGZyb21UaWVyOiBTdWJzY3JpcHRpb25UaWVyO1xyXG4gIHRvVGllcjogU3Vic2NyaXB0aW9uVGllcjtcclxuICBpc1VwZ3JhZGU6IGJvb2xlYW47XHJcbiAgaXNEb3duZ3JhZGU6IGJvb2xlYW47XHJcbiAgZmVhdHVyZUNoYW5nZXM6IHtcclxuICAgIGdhaW5lZDogc3RyaW5nW107XHJcbiAgICBsb3N0OiBzdHJpbmdbXTtcclxuICB9O1xyXG4gIHVzYWdlSW1wYWN0OiB7XHJcbiAgICBvdmVyTGltaXRJdGVtczogQXJyYXk8e1xyXG4gICAgICB0eXBlOiBzdHJpbmc7XHJcbiAgICAgIGN1cnJlbnQ6IG51bWJlcjtcclxuICAgICAgbmV3TGltaXQ6IG51bWJlcjtcclxuICAgICAgaW1wYWN0OiBzdHJpbmc7XHJcbiAgICB9PjtcclxuICB9O1xyXG4gIGNvc3RJbXBhY3Q6IHtcclxuICAgIGN1cnJlbnRDb3N0OiBudW1iZXI7XHJcbiAgICBuZXdDb3N0OiBudW1iZXI7XHJcbiAgICBtb250aGx5RGlmZmVyZW5jZTogbnVtYmVyO1xyXG4gICAgcHJvcmF0aW9uQW1vdW50OiBudW1iZXI7XHJcbiAgICBwcm9yYXRpb25EZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIH07XHJcbiAgd2FybmluZ3M6IHN0cmluZ1tdO1xyXG4gIGNhblRyYW5zaXRpb246IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgVXNlVGllclRyYW5zaXRpb25SZXR1cm4ge1xyXG4gIC8vIEN1cnJlbnQgc3RhdGVcclxuICBjdXJyZW50VGllcjogU3Vic2NyaXB0aW9uVGllciB8IG51bGw7XHJcbiAgYXZhaWxhYmxlVXBncmFkZXM6IFN1YnNjcmlwdGlvblRpZXJbXTtcclxuICBhdmFpbGFibGVEb3duZ3JhZGVzOiBTdWJzY3JpcHRpb25UaWVyW107XHJcbiAgaXNMb2FkaW5nOiBib29sZWFuO1xyXG4gIGVycm9yOiBzdHJpbmcgfCBudWxsO1xyXG4gIFxyXG4gIC8vIEFuYWx5c2lzXHJcbiAgYW5hbHl6ZVRyYW5zaXRpb246ICh0YXJnZXRUaWVyOiBTdWJzY3JpcHRpb25UaWVyKSA9PiBQcm9taXNlPFRpZXJUcmFuc2l0aW9uQW5hbHlzaXM+O1xyXG4gIFxyXG4gIC8vIEV4ZWN1dGlvblxyXG4gIGV4ZWN1dGVUcmFuc2l0aW9uOiAodGFyZ2V0VGllcjogU3Vic2NyaXB0aW9uVGllcikgPT4gUHJvbWlzZTx7XHJcbiAgICBzdWNjZXNzOiBib29sZWFuO1xyXG4gICAgbWVzc2FnZTogc3RyaW5nO1xyXG4gIH0+O1xyXG4gIFxyXG4gIC8vIFV0aWxpdGllc1xyXG4gIGdldFRpZXJEaXNwbGF5TmFtZTogKHRpZXI6IFN1YnNjcmlwdGlvblRpZXIpID0+IHN0cmluZztcclxuICBnZXRUaWVyUHJpY2U6ICh0aWVyOiBTdWJzY3JpcHRpb25UaWVyKSA9PiBudW1iZXI7XHJcbiAgdmFsaWRhdGVUcmFuc2l0aW9uOiAodGFyZ2V0VGllcjogU3Vic2NyaXB0aW9uVGllcikgPT4geyB2YWxpZDogYm9vbGVhbjsgcmVhc29uczogc3RyaW5nW10gfTtcclxuICBcclxuICAvLyBTdGF0ZSBtYW5hZ2VtZW50XHJcbiAgY2xlYXJFcnJvcjogKCkgPT4gdm9pZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIE1haW4gdGllciB0cmFuc2l0aW9uIGhvb2tcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VUaWVyVHJhbnNpdGlvbigpOiBVc2VUaWVyVHJhbnNpdGlvblJldHVybiB7XHJcbiAgY29uc3QgeyBvcmcgfSA9IHVzZVVzZXIoKTtcclxuICBjb25zdCB7IHN1YnNjcmlwdGlvblBsYW4sIHRpZXIsIGN1cnJlbnRVc2FnZSB9ID0gdXNlU3Vic2NyaXB0aW9uKCk7XHJcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xyXG4gIFxyXG4gIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KCk7XHJcblxyXG4gIC8vIEN1cnJlbnQgdGllciBhbmQgYXZhaWxhYmxlIHRyYW5zaXRpb25zXHJcbiAgY29uc3QgY3VycmVudFRpZXIgPSB0aWVyIGFzIFN1YnNjcmlwdGlvblRpZXIgfCBudWxsO1xyXG4gIGNvbnN0IHsgdXBncmFkZXM6IGF2YWlsYWJsZVVwZ3JhZGVzLCBkb3duZ3JhZGVzOiBhdmFpbGFibGVEb3duZ3JhZGVzIH0gPSB1c2VNZW1vKCgpID0+IHtcclxuICAgIGlmICghY3VycmVudFRpZXIpIHJldHVybiB7IHVwZ3JhZGVzOiBbXSwgZG93bmdyYWRlczogW10gfTtcclxuICAgIHJldHVybiBTdWJzY3JpcHRpb25TZXJ2aWNlLmdldEF2YWlsYWJsZVRyYW5zaXRpb25zKGN1cnJlbnRUaWVyKTtcclxuICB9LCBbY3VycmVudFRpZXJdKTtcclxuXHJcbiAgLy8gR2V0IGN1cnJlbnQgdXNhZ2UgZGF0YVxyXG4gIGNvbnN0IGdldEN1cnJlbnRVc2FnZURhdGEgPSB1c2VDYWxsYmFjayhhc3luYyAoKTogUHJvbWlzZTxVc2FnZURhdGE+ID0+IHtcclxuICAgIGlmICghb3JnKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYXZhdGFyc0NvdW50OiAwLFxyXG4gICAgICAgIGNvbGxlY3Rpb25zQ291bnQ6IDAsXHJcbiAgICAgICAgc2Vzc2lvbnNUaGlzTW9udGg6IDAsXHJcbiAgICAgICAgZGF0YVJldGVudGlvbk1vbnRoczogMTJcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBHZXQgYXZhdGFyIGNvdW50XHJcbiAgICAgIGNvbnN0IHsgZGF0YTogYXZhdGFycyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnYXZhdGFycycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxyXG4gICAgICAgIC5lcSgnb3JnX2lkJywgb3JnLmlkKTtcclxuXHJcbiAgICAgIC8vIEdldCBjb2xsZWN0aW9ucyBjb3VudCAoc2ltcGxpZmllZCAtIHdvdWxkIG5vcm1hbGx5IGJlIHBlci1hdmF0YXIpXHJcbiAgICAgIGNvbnN0IHsgZGF0YTogY29sbGVjdGlvbnMgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ2dhbWVfY29sbGVjdGlvbnMnKVxyXG4gICAgICAgIC5zZWxlY3QoJ2lkJylcclxuICAgICAgICAuaW4oJ2F2YXRhcl9pZCcsIChhdmF0YXJzIHx8IFtdKS5tYXAoKGE6IHsgaWQ6IHN0cmluZyB9KSA9PiBhLmlkKSk7XHJcblxyXG4gICAgICAvLyBHZXQgc2Vzc2lvbnMgdGhpcyBtb250aFxyXG4gICAgICBjb25zdCBzdGFydE9mTW9udGggPSBuZXcgRGF0ZSgpO1xyXG4gICAgICBzdGFydE9mTW9udGguc2V0RGF0ZSgxKTtcclxuICAgICAgc3RhcnRPZk1vbnRoLnNldEhvdXJzKDAsIDAsIDAsIDApO1xyXG5cclxuICAgICAgY29uc3QgeyBkYXRhOiBzZXNzaW9ucyB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnZ2FtZV9zZXNzaW9ucycpXHJcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxyXG4gICAgICAgIC5lcSgnb3JnX2lkJywgb3JnLmlkKVxyXG4gICAgICAgIC5ndGUoJ2NyZWF0ZWRfYXQnLCBzdGFydE9mTW9udGgudG9JU09TdHJpbmcoKSk7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGF2YXRhcnNDb3VudDogYXZhdGFycz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgICAgY29sbGVjdGlvbnNDb3VudDogY29sbGVjdGlvbnM/Lmxlbmd0aCB8fCAwLFxyXG4gICAgICAgIHNlc3Npb25zVGhpc01vbnRoOiBzZXNzaW9ucz8ubGVuZ3RoIHx8IDAsXHJcbiAgICAgICAgZGF0YVJldGVudGlvbk1vbnRoczogMTIgLy8gRGVmYXVsdFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdldCB1c2FnZSBkYXRhOicsIGVycik7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgYXZhdGFyc0NvdW50OiBjdXJyZW50VXNhZ2UuYXZhdGFyc0NvdW50LFxyXG4gICAgICAgIGNvbGxlY3Rpb25zQ291bnQ6IDAsXHJcbiAgICAgICAgc2Vzc2lvbnNUaGlzTW9udGg6IDAsXHJcbiAgICAgICAgZGF0YVJldGVudGlvbk1vbnRoczogMTJcclxuICAgICAgfTtcclxuICAgIH1cclxuICB9LCBbb3JnLCBzdXBhYmFzZSwgY3VycmVudFVzYWdlLmF2YXRhcnNDb3VudF0pO1xyXG5cclxuICAvLyBBbmFseXplIHRyYW5zaXRpb24gaW1wYWN0XHJcbiAgY29uc3QgYW5hbHl6ZVRyYW5zaXRpb24gPSB1c2VDYWxsYmFjayhhc3luYyAodGFyZ2V0VGllcjogU3Vic2NyaXB0aW9uVGllcik6IFByb21pc2U8VGllclRyYW5zaXRpb25BbmFseXNpcz4gPT4ge1xyXG4gICAgaWYgKCFjdXJyZW50VGllciB8fCAhc3Vic2NyaXB0aW9uUGxhbikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGN1cnJlbnQgc3Vic2NyaXB0aW9uIHRvIGFuYWx5emUnKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICBzZXRFcnJvcihudWxsKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1c2FnZURhdGEgPSBhd2FpdCBnZXRDdXJyZW50VXNhZ2VEYXRhKCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBHZXQgYmFzaWMgYW5hbHlzaXNcclxuICAgICAgY29uc3QgYW5hbHlzaXMgPSBTdWJzY3JpcHRpb25TZXJ2aWNlLmFuYWx5emVUaWVyVHJhbnNpdGlvbihjdXJyZW50VGllciwgdGFyZ2V0VGllciwgdXNhZ2VEYXRhKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEdldCBjb3N0IGluZm9ybWF0aW9uXHJcbiAgICAgIGNvbnN0IGN1cnJlbnRDb3N0ID0gcGFyc2VGbG9hdChzdWJzY3JpcHRpb25QbGFuLmJhc2VfcHJpY2UudG9TdHJpbmcoKSk7XHJcbiAgICAgIGNvbnN0IG5ld0Nvc3QgPSBnZXRUaWVyUHJpY2UodGFyZ2V0VGllcik7XHJcbiAgICAgIGNvbnN0IG1vbnRobHlEaWZmZXJlbmNlID0gbmV3Q29zdCAtIGN1cnJlbnRDb3N0O1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcHJvcmF0aW9uID0gU3Vic2NyaXB0aW9uU2VydmljZS5jYWxjdWxhdGVQcm9yYXRpb24oY3VycmVudENvc3QsIG5ld0Nvc3QpO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBmcm9tVGllcjogY3VycmVudFRpZXIsXHJcbiAgICAgICAgdG9UaWVyOiB0YXJnZXRUaWVyLFxyXG4gICAgICAgIGlzVXBncmFkZTogYW5hbHlzaXMuaXNVcGdyYWRlLFxyXG4gICAgICAgIGlzRG93bmdyYWRlOiBhbmFseXNpcy5pc0Rvd25ncmFkZSxcclxuICAgICAgICBmZWF0dXJlQ2hhbmdlczoge1xyXG4gICAgICAgICAgZ2FpbmVkOiBhbmFseXNpcy5mZWF0dXJlQ2hhbmdlcy5nYWluZWQsXHJcbiAgICAgICAgICBsb3N0OiBhbmFseXNpcy5mZWF0dXJlQ2hhbmdlcy5sb3N0XHJcbiAgICAgICAgfSxcclxuICAgICAgICB1c2FnZUltcGFjdDoge1xyXG4gICAgICAgICAgb3ZlckxpbWl0SXRlbXM6IGFuYWx5c2lzLnVzYWdlSW1wYWN0Lm92ZXJMaW1pdEl0ZW1zXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb3N0SW1wYWN0OiB7XHJcbiAgICAgICAgICBjdXJyZW50Q29zdCxcclxuICAgICAgICAgIG5ld0Nvc3QsXHJcbiAgICAgICAgICBtb250aGx5RGlmZmVyZW5jZSxcclxuICAgICAgICAgIHByb3JhdGlvbkFtb3VudDogcHJvcmF0aW9uLnByb3JhdGlvbkFtb3VudCxcclxuICAgICAgICAgIHByb3JhdGlvbkRlc2NyaXB0aW9uOiBwcm9yYXRpb24uZGVzY3JpcHRpb25cclxuICAgICAgICB9LFxyXG4gICAgICAgIHdhcm5pbmdzOiBhbmFseXNpcy53YXJuaW5ncyxcclxuICAgICAgICBjYW5UcmFuc2l0aW9uOiBhbmFseXNpcy5jYW5UcmFuc2l0aW9uXHJcbiAgICAgIH07XHJcblxyXG4gICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBhbmFseXplIHRyYW5zaXRpb24nO1xyXG4gICAgICBzZXRFcnJvcihtZXNzYWdlKTtcclxuICAgICAgdGhyb3cgZXJyO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcclxuICAgIH1cclxuICB9LCBbY3VycmVudFRpZXIsIHN1YnNjcmlwdGlvblBsYW4sIGdldEN1cnJlbnRVc2FnZURhdGFdKTtcclxuXHJcbiAgLy8gRXhlY3V0ZSB0aWVyIHRyYW5zaXRpb25cclxuICBjb25zdCBleGVjdXRlVHJhbnNpdGlvbiA9IHVzZUNhbGxiYWNrKGFzeW5jICh0YXJnZXRUaWVyOiBTdWJzY3JpcHRpb25UaWVyKTogUHJvbWlzZTx7XHJcbiAgICBzdWNjZXNzOiBib29sZWFuO1xyXG4gICAgbWVzc2FnZTogc3RyaW5nO1xyXG4gIH0+ID0+IHtcclxuICAgIGlmICghb3JnIHx8ICFjdXJyZW50VGllcikge1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIG9yZ2FuaXphdGlvbiBvciBjdXJyZW50IHRpZXIgZm91bmQnKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRJc0xvYWRpbmcodHJ1ZSk7XHJcbiAgICBzZXRFcnJvcihudWxsKTtcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBWYWxpZGF0ZSB0cmFuc2l0aW9uIGZpcnN0XHJcbiAgICAgIGNvbnN0IHVzYWdlRGF0YSA9IGF3YWl0IGdldEN1cnJlbnRVc2FnZURhdGEoKTtcclxuICAgICAgY29uc3QgdmFsaWRhdGlvbiA9IFN1YnNjcmlwdGlvblNlcnZpY2UudmFsaWRhdGVUaWVyVHJhbnNpdGlvbihjdXJyZW50VGllciwgdGFyZ2V0VGllciwgdXNhZ2VEYXRhKTtcclxuICAgICAgXHJcbiAgICAgIGlmICghdmFsaWRhdGlvbi52YWxpZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVHJhbnNpdGlvbiBub3QgYWxsb3dlZDogJHt2YWxpZGF0aW9uLnJlYXNvbnMuam9pbignLCAnKX1gKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gR2V0IG5ldyBzdWJzY3JpcHRpb24gcGxhblxyXG4gICAgICBjb25zdCB7IGRhdGE6IG5ld1BsYW4sIGVycm9yOiBwbGFuRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAgICAgLmZyb20oJ3N1YnNjcmlwdGlvbl9wbGFucycpXHJcbiAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgLmVxKCd0aWVyJywgdGFyZ2V0VGllcilcclxuICAgICAgICAuZXEoJ2FjdGl2ZScsIHRydWUpXHJcbiAgICAgICAgLm9yZGVyKCdiYXNlX3ByaWNlJywgeyBhc2NlbmRpbmc6IHRydWUgfSlcclxuICAgICAgICAubGltaXQoMSlcclxuICAgICAgICAuc2luZ2xlKCk7XHJcblxyXG4gICAgICBpZiAocGxhbkVycm9yKSB0aHJvdyBwbGFuRXJyb3I7XHJcblxyXG4gICAgICAvLyBVcGRhdGUgb3JnYW5pemF0aW9uIHN1YnNjcmlwdGlvblxyXG4gICAgICBjb25zdCB7IGVycm9yOiB1cGRhdGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcclxuICAgICAgICAuZnJvbSgnb3JnYW5pemF0aW9ucycpXHJcbiAgICAgICAgLnVwZGF0ZSh7XHJcbiAgICAgICAgICBzdWJzY3JpcHRpb25fcGxhbl9pZDogbmV3UGxhbi5pZCxcclxuICAgICAgICAgIHVwZGF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmVxKCdpZCcsIG9yZy5pZCk7XHJcblxyXG4gICAgICBpZiAodXBkYXRlRXJyb3IpIHRocm93IHVwZGF0ZUVycm9yO1xyXG5cclxuICAgICAgLy8gTG9nIHRoZSB0cmFuc2l0aW9uXHJcbiAgICAgIGxvZ2dlci5pbmZvKCdUaWVyIHRyYW5zaXRpb24gY29tcGxldGVkOicsIHtcclxuICAgICAgICBvcmdJZDogb3JnLmlkLFxyXG4gICAgICAgIGZyb21UaWVyOiBjdXJyZW50VGllcixcclxuICAgICAgICB0b1RpZXI6IHRhcmdldFRpZXIsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKClcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCB0aWVyRGlzcGxheU5hbWUgPSBnZXRUaWVyRGlzcGxheU5hbWUodGFyZ2V0VGllcik7XHJcbiAgICAgIGNvbnN0IGFjdGlvbiA9IFN1YnNjcmlwdGlvblNlcnZpY2UuYW5hbHl6ZVRpZXJUcmFuc2l0aW9uKGN1cnJlbnRUaWVyLCB0YXJnZXRUaWVyLCB1c2FnZURhdGEpLmlzVXBncmFkZSBcclxuICAgICAgICA/ICd1cGdyYWRlZCcgXHJcbiAgICAgICAgOiAnY2hhbmdlZCc7XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZTogYFN1Y2Nlc3NmdWxseSAke2FjdGlvbn0gdG8gJHt0aWVyRGlzcGxheU5hbWV9IWBcclxuICAgICAgfTtcclxuXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgY29uc3QgbWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRmFpbGVkIHRvIGV4ZWN1dGUgdHJhbnNpdGlvbic7XHJcbiAgICAgIHNldEVycm9yKG1lc3NhZ2UpO1xyXG4gICAgICBsb2dnZXIuZXJyb3IoJ1RpZXIgdHJhbnNpdGlvbiBmYWlsZWQ6JywgZXJyKTtcclxuICAgICAgXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZVxyXG4gICAgICB9O1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcclxuICAgIH1cclxuICB9LCBbb3JnLCBjdXJyZW50VGllciwgc3VwYWJhc2UsIGdldEN1cnJlbnRVc2FnZURhdGFdKTtcclxuXHJcbiAgLy8gVXRpbGl0eSBmdW5jdGlvbnNcclxuICBjb25zdCBnZXRUaWVyRGlzcGxheU5hbWUgPSB1c2VDYWxsYmFjaygodGllcjogU3Vic2NyaXB0aW9uVGllcik6IHN0cmluZyA9PiB7XHJcbiAgICBjb25zdCB0aWVyTmFtZXMgPSB7XHJcbiAgICAgIHBlcnNvbmFsOiAnUGVyc29uYWwgUGxhbicsXHJcbiAgICAgIHByb2Zlc3Npb25hbDogJ1Byb2Zlc3Npb25hbCBQbGFuJyxcclxuICAgICAgZW50ZXJwcmlzZTogJ0VudGVycHJpc2UgUGxhbidcclxuICAgIH07XHJcbiAgICByZXR1cm4gdGllck5hbWVzW3RpZXJdO1xyXG4gIH0sIFtdKTtcclxuXHJcbiAgY29uc3QgZ2V0VGllclByaWNlID0gdXNlQ2FsbGJhY2soKHRpZXI6IFN1YnNjcmlwdGlvblRpZXIpOiBudW1iZXIgPT4ge1xyXG4gICAgY29uc3QgcHJpY2VzID0ge1xyXG4gICAgICBwZXJzb25hbDogOS45OSxcclxuICAgICAgcHJvZmVzc2lvbmFsOiAxOTkuOTksXHJcbiAgICAgIGVudGVycHJpc2U6IDE0OTkuOTlcclxuICAgIH07XHJcbiAgICByZXR1cm4gcHJpY2VzW3RpZXJdO1xyXG4gIH0sIFtdKTtcclxuXHJcbiAgY29uc3QgdmFsaWRhdGVUcmFuc2l0aW9uID0gdXNlQ2FsbGJhY2soKHRhcmdldFRpZXI6IFN1YnNjcmlwdGlvblRpZXIpOiB7IHZhbGlkOiBib29sZWFuOyByZWFzb25zOiBzdHJpbmdbXSB9ID0+IHtcclxuICAgIGlmICghY3VycmVudFRpZXIpIHtcclxuICAgICAgcmV0dXJuIHsgdmFsaWQ6IGZhbHNlLCByZWFzb25zOiBbJ05vIGN1cnJlbnQgdGllciBmb3VuZCddIH07XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXNlIGN1cnJlbnQgdXNhZ2UgZGF0YSBzeW5jaHJvbm91c2x5IChmYWxsYmFjayB2YWx1ZXMpXHJcbiAgICBjb25zdCB1c2FnZURhdGE6IFVzYWdlRGF0YSA9IHtcclxuICAgICAgYXZhdGFyc0NvdW50OiBjdXJyZW50VXNhZ2UuYXZhdGFyc0NvdW50LFxyXG4gICAgICBjb2xsZWN0aW9uc0NvdW50OiAwLCAvLyBXb3VsZCBuZWVkIHRvIGZldGNoIHRoaXNcclxuICAgICAgc2Vzc2lvbnNUaGlzTW9udGg6IDAsIC8vIFdvdWxkIG5lZWQgdG8gZmV0Y2ggdGhpc1xyXG4gICAgICBkYXRhUmV0ZW50aW9uTW9udGhzOiAxMlxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gU3Vic2NyaXB0aW9uU2VydmljZS52YWxpZGF0ZVRpZXJUcmFuc2l0aW9uKGN1cnJlbnRUaWVyLCB0YXJnZXRUaWVyLCB1c2FnZURhdGEpO1xyXG4gIH0sIFtjdXJyZW50VGllciwgY3VycmVudFVzYWdlLmF2YXRhcnNDb3VudF0pO1xyXG5cclxuICBjb25zdCBjbGVhckVycm9yID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xyXG4gICAgc2V0RXJyb3IobnVsbCk7XHJcbiAgfSwgW10pO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgLy8gQ3VycmVudCBzdGF0ZVxyXG4gICAgY3VycmVudFRpZXIsXHJcbiAgICBhdmFpbGFibGVVcGdyYWRlcyxcclxuICAgIGF2YWlsYWJsZURvd25ncmFkZXMsXHJcbiAgICBpc0xvYWRpbmcsXHJcbiAgICBlcnJvcixcclxuICAgIFxyXG4gICAgLy8gQW5hbHlzaXNcclxuICAgIGFuYWx5emVUcmFuc2l0aW9uLFxyXG4gICAgXHJcbiAgICAvLyBFeGVjdXRpb25cclxuICAgIGV4ZWN1dGVUcmFuc2l0aW9uLFxyXG4gICAgXHJcbiAgICAvLyBVdGlsaXRpZXNcclxuICAgIGdldFRpZXJEaXNwbGF5TmFtZSxcclxuICAgIGdldFRpZXJQcmljZSxcclxuICAgIHZhbGlkYXRlVHJhbnNpdGlvbixcclxuICAgIFxyXG4gICAgLy8gU3RhdGUgbWFuYWdlbWVudFxyXG4gICAgY2xlYXJFcnJvclxyXG4gIH07XHJcbn0gIl0sIm5hbWVzIjpbInVzZVRpZXJUcmFuc2l0aW9uIiwib3JnIiwidXNlVXNlciIsInN1YnNjcmlwdGlvblBsYW4iLCJ0aWVyIiwiY3VycmVudFVzYWdlIiwidXNlU3Vic2NyaXB0aW9uIiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwidXNlU3RhdGUiLCJlcnJvciIsInNldEVycm9yIiwic3VwYWJhc2UiLCJjcmVhdGVDbGllbnQiLCJjdXJyZW50VGllciIsInVwZ3JhZGVzIiwiYXZhaWxhYmxlVXBncmFkZXMiLCJkb3duZ3JhZGVzIiwiYXZhaWxhYmxlRG93bmdyYWRlcyIsInVzZU1lbW8iLCJTdWJzY3JpcHRpb25TZXJ2aWNlIiwiZ2V0QXZhaWxhYmxlVHJhbnNpdGlvbnMiLCJnZXRDdXJyZW50VXNhZ2VEYXRhIiwidXNlQ2FsbGJhY2siLCJhdmF0YXJzQ291bnQiLCJjb2xsZWN0aW9uc0NvdW50Iiwic2Vzc2lvbnNUaGlzTW9udGgiLCJkYXRhUmV0ZW50aW9uTW9udGhzIiwiZGF0YSIsImF2YXRhcnMiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsImNvbGxlY3Rpb25zIiwiaW4iLCJtYXAiLCJhIiwic3RhcnRPZk1vbnRoIiwiRGF0ZSIsInNldERhdGUiLCJzZXRIb3VycyIsInNlc3Npb25zIiwiZ3RlIiwidG9JU09TdHJpbmciLCJsZW5ndGgiLCJlcnIiLCJsb2dnZXIiLCJhbmFseXplVHJhbnNpdGlvbiIsInRhcmdldFRpZXIiLCJFcnJvciIsInVzYWdlRGF0YSIsImFuYWx5c2lzIiwiYW5hbHl6ZVRpZXJUcmFuc2l0aW9uIiwiY3VycmVudENvc3QiLCJwYXJzZUZsb2F0IiwiYmFzZV9wcmljZSIsInRvU3RyaW5nIiwibmV3Q29zdCIsImdldFRpZXJQcmljZSIsIm1vbnRobHlEaWZmZXJlbmNlIiwicHJvcmF0aW9uIiwiY2FsY3VsYXRlUHJvcmF0aW9uIiwiZnJvbVRpZXIiLCJ0b1RpZXIiLCJpc1VwZ3JhZGUiLCJpc0Rvd25ncmFkZSIsImZlYXR1cmVDaGFuZ2VzIiwiZ2FpbmVkIiwibG9zdCIsInVzYWdlSW1wYWN0Iiwib3ZlckxpbWl0SXRlbXMiLCJjb3N0SW1wYWN0IiwicHJvcmF0aW9uQW1vdW50IiwicHJvcmF0aW9uRGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbiIsIndhcm5pbmdzIiwiY2FuVHJhbnNpdGlvbiIsIm1lc3NhZ2UiLCJleGVjdXRlVHJhbnNpdGlvbiIsInZhbGlkYXRpb24iLCJ2YWxpZGF0ZVRpZXJUcmFuc2l0aW9uIiwidmFsaWQiLCJyZWFzb25zIiwiam9pbiIsIm5ld1BsYW4iLCJwbGFuRXJyb3IiLCJvcmRlciIsImFzY2VuZGluZyIsImxpbWl0Iiwic2luZ2xlIiwidXBkYXRlRXJyb3IiLCJ1cGRhdGUiLCJzdWJzY3JpcHRpb25fcGxhbl9pZCIsInVwZGF0ZWRfYXQiLCJpbmZvIiwib3JnSWQiLCJ0aW1lc3RhbXAiLCJ0aWVyRGlzcGxheU5hbWUiLCJnZXRUaWVyRGlzcGxheU5hbWUiLCJhY3Rpb24iLCJzdWNjZXNzIiwidGllck5hbWVzIiwicGVyc29uYWwiLCJwcm9mZXNzaW9uYWwiLCJlbnRlcnByaXNlIiwicHJpY2VzIiwidmFsaWRhdGVUcmFuc2l0aW9uIiwiY2xlYXJFcnJvciJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Q0FJQzs7OzsrQkFzRWVBOzs7ZUFBQUE7Ozt1QkFwRStCOzZCQUN2QjtpQ0FDUTtxQ0FLekI7d0JBQ3NCO3dCQUNOO0FBMkRoQixTQUFTQTtJQUNkLE1BQU0sRUFBRUMsR0FBRyxFQUFFLEdBQUdDLElBQUFBLG9CQUFPO0lBQ3ZCLE1BQU0sRUFBRUMsZ0JBQWdCLEVBQUVDLElBQUksRUFBRUMsWUFBWSxFQUFFLEdBQUdDLElBQUFBLGdDQUFlO0lBQ2hFLE1BQU0sQ0FBQ0MsV0FBV0MsYUFBYSxHQUFHQyxJQUFBQSxlQUFRLEVBQUM7SUFDM0MsTUFBTSxDQUFDQyxPQUFPQyxTQUFTLEdBQUdGLElBQUFBLGVBQVEsRUFBZ0I7SUFFbEQsTUFBTUcsV0FBV0MsSUFBQUEsb0JBQVk7SUFFN0IseUNBQXlDO0lBQ3pDLE1BQU1DLGNBQWNWO0lBQ3BCLE1BQU0sRUFBRVcsVUFBVUMsaUJBQWlCLEVBQUVDLFlBQVlDLG1CQUFtQixFQUFFLEdBQUdDLElBQUFBLGNBQU8sRUFBQztRQUMvRSxJQUFJLENBQUNMLGFBQWEsT0FBTztZQUFFQyxVQUFVLEVBQUU7WUFBRUUsWUFBWSxFQUFFO1FBQUM7UUFDeEQsT0FBT0csd0NBQW1CLENBQUNDLHVCQUF1QixDQUFDUDtJQUNyRCxHQUFHO1FBQUNBO0tBQVk7SUFFaEIseUJBQXlCO0lBQ3pCLE1BQU1RLHNCQUFzQkMsSUFBQUEsa0JBQVcsRUFBQztRQUN0QyxJQUFJLENBQUN0QixLQUFLO1lBQ1IsT0FBTztnQkFDTHVCLGNBQWM7Z0JBQ2RDLGtCQUFrQjtnQkFDbEJDLG1CQUFtQjtnQkFDbkJDLHFCQUFxQjtZQUN2QjtRQUNGO1FBRUEsSUFBSTtZQUNGLG1CQUFtQjtZQUNuQixNQUFNLEVBQUVDLE1BQU1DLE9BQU8sRUFBRSxHQUFHLE1BQU1qQixTQUM3QmtCLElBQUksQ0FBQyxXQUNMQyxNQUFNLENBQUMsTUFDUEMsRUFBRSxDQUFDLFVBQVUvQixJQUFJZ0MsRUFBRTtZQUV0QixvRUFBb0U7WUFDcEUsTUFBTSxFQUFFTCxNQUFNTSxXQUFXLEVBQUUsR0FBRyxNQUFNdEIsU0FDakNrQixJQUFJLENBQUMsb0JBQ0xDLE1BQU0sQ0FBQyxNQUNQSSxFQUFFLENBQUMsYUFBYSxBQUFDTixDQUFBQSxXQUFXLEVBQUUsQUFBRCxFQUFHTyxHQUFHLENBQUMsQ0FBQ0MsSUFBc0JBLEVBQUVKLEVBQUU7WUFFbEUsMEJBQTBCO1lBQzFCLE1BQU1LLGVBQWUsSUFBSUM7WUFDekJELGFBQWFFLE9BQU8sQ0FBQztZQUNyQkYsYUFBYUcsUUFBUSxDQUFDLEdBQUcsR0FBRyxHQUFHO1lBRS9CLE1BQU0sRUFBRWIsTUFBTWMsUUFBUSxFQUFFLEdBQUcsTUFBTTlCLFNBQzlCa0IsSUFBSSxDQUFDLGlCQUNMQyxNQUFNLENBQUMsTUFDUEMsRUFBRSxDQUFDLFVBQVUvQixJQUFJZ0MsRUFBRSxFQUNuQlUsR0FBRyxDQUFDLGNBQWNMLGFBQWFNLFdBQVc7WUFFN0MsT0FBTztnQkFDTHBCLGNBQWNLLFNBQVNnQixVQUFVO2dCQUNqQ3BCLGtCQUFrQlMsYUFBYVcsVUFBVTtnQkFDekNuQixtQkFBbUJnQixVQUFVRyxVQUFVO2dCQUN2Q2xCLHFCQUFxQixHQUFHLFVBQVU7WUFDcEM7UUFDRixFQUFFLE9BQU9tQixLQUFLO1lBQ1pDLGNBQU0sQ0FBQ3JDLEtBQUssQ0FBQyw2QkFBNkJvQztZQUMxQyxPQUFPO2dCQUNMdEIsY0FBY25CLGFBQWFtQixZQUFZO2dCQUN2Q0Msa0JBQWtCO2dCQUNsQkMsbUJBQW1CO2dCQUNuQkMscUJBQXFCO1lBQ3ZCO1FBQ0Y7SUFDRixHQUFHO1FBQUMxQjtRQUFLVztRQUFVUCxhQUFhbUIsWUFBWTtLQUFDO0lBRTdDLDRCQUE0QjtJQUM1QixNQUFNd0Isb0JBQW9CekIsSUFBQUEsa0JBQVcsRUFBQyxPQUFPMEI7UUFDM0MsSUFBSSxDQUFDbkMsZUFBZSxDQUFDWCxrQkFBa0I7WUFDckMsTUFBTSxJQUFJK0MsTUFBTTtRQUNsQjtRQUVBMUMsYUFBYTtRQUNiRyxTQUFTO1FBRVQsSUFBSTtZQUNGLE1BQU13QyxZQUFZLE1BQU03QjtZQUV4QixxQkFBcUI7WUFDckIsTUFBTThCLFdBQVdoQyx3Q0FBbUIsQ0FBQ2lDLHFCQUFxQixDQUFDdkMsYUFBYW1DLFlBQVlFO1lBRXBGLHVCQUF1QjtZQUN2QixNQUFNRyxjQUFjQyxXQUFXcEQsaUJBQWlCcUQsVUFBVSxDQUFDQyxRQUFRO1lBQ25FLE1BQU1DLFVBQVVDLGFBQWFWO1lBQzdCLE1BQU1XLG9CQUFvQkYsVUFBVUo7WUFFcEMsTUFBTU8sWUFBWXpDLHdDQUFtQixDQUFDMEMsa0JBQWtCLENBQUNSLGFBQWFJO1lBRXRFLE9BQU87Z0JBQ0xLLFVBQVVqRDtnQkFDVmtELFFBQVFmO2dCQUNSZ0IsV0FBV2IsU0FBU2EsU0FBUztnQkFDN0JDLGFBQWFkLFNBQVNjLFdBQVc7Z0JBQ2pDQyxnQkFBZ0I7b0JBQ2RDLFFBQVFoQixTQUFTZSxjQUFjLENBQUNDLE1BQU07b0JBQ3RDQyxNQUFNakIsU0FBU2UsY0FBYyxDQUFDRSxJQUFJO2dCQUNwQztnQkFDQUMsYUFBYTtvQkFDWEMsZ0JBQWdCbkIsU0FBU2tCLFdBQVcsQ0FBQ0MsY0FBYztnQkFDckQ7Z0JBQ0FDLFlBQVk7b0JBQ1ZsQjtvQkFDQUk7b0JBQ0FFO29CQUNBYSxpQkFBaUJaLFVBQVVZLGVBQWU7b0JBQzFDQyxzQkFBc0JiLFVBQVVjLFdBQVc7Z0JBQzdDO2dCQUNBQyxVQUFVeEIsU0FBU3dCLFFBQVE7Z0JBQzNCQyxlQUFlekIsU0FBU3lCLGFBQWE7WUFDdkM7UUFFRixFQUFFLE9BQU8vQixLQUFLO1lBQ1osTUFBTWdDLFVBQVVoQyxlQUFlSSxRQUFRSixJQUFJZ0MsT0FBTyxHQUFHO1lBQ3JEbkUsU0FBU21FO1lBQ1QsTUFBTWhDO1FBQ1IsU0FBVTtZQUNSdEMsYUFBYTtRQUNmO0lBQ0YsR0FBRztRQUFDTTtRQUFhWDtRQUFrQm1CO0tBQW9CO0lBRXZELDBCQUEwQjtJQUMxQixNQUFNeUQsb0JBQW9CeEQsSUFBQUEsa0JBQVcsRUFBQyxPQUFPMEI7UUFJM0MsSUFBSSxDQUFDaEQsT0FBTyxDQUFDYSxhQUFhO1lBQ3hCLE1BQU0sSUFBSW9DLE1BQU07UUFDbEI7UUFFQTFDLGFBQWE7UUFDYkcsU0FBUztRQUVULElBQUk7WUFDRiw0QkFBNEI7WUFDNUIsTUFBTXdDLFlBQVksTUFBTTdCO1lBQ3hCLE1BQU0wRCxhQUFhNUQsd0NBQW1CLENBQUM2RCxzQkFBc0IsQ0FBQ25FLGFBQWFtQyxZQUFZRTtZQUV2RixJQUFJLENBQUM2QixXQUFXRSxLQUFLLEVBQUU7Z0JBQ3JCLE1BQU0sSUFBSWhDLE1BQU0sQ0FBQyx3QkFBd0IsRUFBRThCLFdBQVdHLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDLE9BQU87WUFDNUU7WUFFQSw0QkFBNEI7WUFDNUIsTUFBTSxFQUFFeEQsTUFBTXlELE9BQU8sRUFBRTNFLE9BQU80RSxTQUFTLEVBQUUsR0FBRyxNQUFNMUUsU0FDL0NrQixJQUFJLENBQUMsc0JBQ0xDLE1BQU0sQ0FBQyxLQUNQQyxFQUFFLENBQUMsUUFBUWlCLFlBQ1hqQixFQUFFLENBQUMsVUFBVSxNQUNidUQsS0FBSyxDQUFDLGNBQWM7Z0JBQUVDLFdBQVc7WUFBSyxHQUN0Q0MsS0FBSyxDQUFDLEdBQ05DLE1BQU07WUFFVCxJQUFJSixXQUFXLE1BQU1BO1lBRXJCLG1DQUFtQztZQUNuQyxNQUFNLEVBQUU1RSxPQUFPaUYsV0FBVyxFQUFFLEdBQUcsTUFBTS9FLFNBQ2xDa0IsSUFBSSxDQUFDLGlCQUNMOEQsTUFBTSxDQUFDO2dCQUNOQyxzQkFBc0JSLFFBQVFwRCxFQUFFO2dCQUNoQzZELFlBQVksSUFBSXZELE9BQU9LLFdBQVc7WUFDcEMsR0FDQ1osRUFBRSxDQUFDLE1BQU0vQixJQUFJZ0MsRUFBRTtZQUVsQixJQUFJMEQsYUFBYSxNQUFNQTtZQUV2QixxQkFBcUI7WUFDckI1QyxjQUFNLENBQUNnRCxJQUFJLENBQUMsOEJBQThCO2dCQUN4Q0MsT0FBTy9GLElBQUlnQyxFQUFFO2dCQUNiOEIsVUFBVWpEO2dCQUNWa0QsUUFBUWY7Z0JBQ1JnRCxXQUFXLElBQUkxRCxPQUFPSyxXQUFXO1lBQ25DO1lBRUEsTUFBTXNELGtCQUFrQkMsbUJBQW1CbEQ7WUFDM0MsTUFBTW1ELFNBQVNoRix3Q0FBbUIsQ0FBQ2lDLHFCQUFxQixDQUFDdkMsYUFBYW1DLFlBQVlFLFdBQVdjLFNBQVMsR0FDbEcsYUFDQTtZQUVKLE9BQU87Z0JBQ0xvQyxTQUFTO2dCQUNUdkIsU0FBUyxDQUFDLGFBQWEsRUFBRXNCLE9BQU8sSUFBSSxFQUFFRixnQkFBZ0IsQ0FBQyxDQUFDO1lBQzFEO1FBRUYsRUFBRSxPQUFPcEQsS0FBSztZQUNaLE1BQU1nQyxVQUFVaEMsZUFBZUksUUFBUUosSUFBSWdDLE9BQU8sR0FBRztZQUNyRG5FLFNBQVNtRTtZQUNUL0IsY0FBTSxDQUFDckMsS0FBSyxDQUFDLDJCQUEyQm9DO1lBRXhDLE9BQU87Z0JBQ0x1RCxTQUFTO2dCQUNUdkI7WUFDRjtRQUNGLFNBQVU7WUFDUnRFLGFBQWE7UUFDZjtJQUNGLEdBQUc7UUFBQ1A7UUFBS2E7UUFBYUY7UUFBVVU7S0FBb0I7SUFFcEQsb0JBQW9CO0lBQ3BCLE1BQU02RSxxQkFBcUI1RSxJQUFBQSxrQkFBVyxFQUFDLENBQUNuQjtRQUN0QyxNQUFNa0csWUFBWTtZQUNoQkMsVUFBVTtZQUNWQyxjQUFjO1lBQ2RDLFlBQVk7UUFDZDtRQUNBLE9BQU9ILFNBQVMsQ0FBQ2xHLEtBQUs7SUFDeEIsR0FBRyxFQUFFO0lBRUwsTUFBTXVELGVBQWVwQyxJQUFBQSxrQkFBVyxFQUFDLENBQUNuQjtRQUNoQyxNQUFNc0csU0FBUztZQUNiSCxVQUFVO1lBQ1ZDLGNBQWM7WUFDZEMsWUFBWTtRQUNkO1FBQ0EsT0FBT0MsTUFBTSxDQUFDdEcsS0FBSztJQUNyQixHQUFHLEVBQUU7SUFFTCxNQUFNdUcscUJBQXFCcEYsSUFBQUEsa0JBQVcsRUFBQyxDQUFDMEI7UUFDdEMsSUFBSSxDQUFDbkMsYUFBYTtZQUNoQixPQUFPO2dCQUFFb0UsT0FBTztnQkFBT0MsU0FBUztvQkFBQztpQkFBd0I7WUFBQztRQUM1RDtRQUVBLHlEQUF5RDtRQUN6RCxNQUFNaEMsWUFBdUI7WUFDM0IzQixjQUFjbkIsYUFBYW1CLFlBQVk7WUFDdkNDLGtCQUFrQjtZQUNsQkMsbUJBQW1CO1lBQ25CQyxxQkFBcUI7UUFDdkI7UUFFQSxPQUFPUCx3Q0FBbUIsQ0FBQzZELHNCQUFzQixDQUFDbkUsYUFBYW1DLFlBQVlFO0lBQzdFLEdBQUc7UUFBQ3JDO1FBQWFULGFBQWFtQixZQUFZO0tBQUM7SUFFM0MsTUFBTW9GLGFBQWFyRixJQUFBQSxrQkFBVyxFQUFDO1FBQzdCWixTQUFTO0lBQ1gsR0FBRyxFQUFFO0lBRUwsT0FBTztRQUNMLGdCQUFnQjtRQUNoQkc7UUFDQUU7UUFDQUU7UUFDQVg7UUFDQUc7UUFFQSxXQUFXO1FBQ1hzQztRQUVBLFlBQVk7UUFDWitCO1FBRUEsWUFBWTtRQUNab0I7UUFDQXhDO1FBQ0FnRDtRQUVBLG1CQUFtQjtRQUNuQkM7SUFDRjtBQUNGIn0=
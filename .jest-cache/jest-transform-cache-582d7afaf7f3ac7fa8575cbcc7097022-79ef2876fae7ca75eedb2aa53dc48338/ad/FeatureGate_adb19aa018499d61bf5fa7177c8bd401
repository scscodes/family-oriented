25e09f9e8a2d709844972661a21142f2
/**
 * FeatureGate Component
 * Conditionally renders content based on subscription tier and feature access
 * Provides upgrade prompts for locked features
 */ 'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    FeatureAvailabilityChip: function() {
        return FeatureAvailabilityChip;
    },
    default: function() {
        return _default;
    },
    useFeatureGate: function() {
        return useFeatureGate;
    }
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _material = require("@mui/material");
const _Lock = /*#__PURE__*/ _interop_require_default(require("@mui/icons-material/Lock"));
const _CheckCircle = /*#__PURE__*/ _interop_require_default(require("@mui/icons-material/CheckCircle"));
const _useSubscription = require("../../../hooks/useSubscription");
const _TierTransitionButton = /*#__PURE__*/ _interop_require_default(require("../../../features/subscription/components/TierTransitionButton"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
/**
 * Feature gate component with multiple display modes
 */ const FeatureGate = /*#__PURE__*/ _react.default.memo(({ feature, children, fallback, showUpgradePrompt = true, mode = 'hide', compact = false })=>{
    const { canAccessFeature, formatFeatureMessage, tier } = (0, _useSubscription.useSubscription)();
    // Memoize access result to prevent unnecessary re-computation
    const accessResult = (0, _react.useMemo)(()=>{
        return canAccessFeature(feature);
    }, [
        canAccessFeature,
        feature
    ]);
    // Memoize formatted message
    const formattedMessage = (0, _react.useMemo)(()=>{
        return formatFeatureMessage(accessResult);
    }, [
        formatFeatureMessage,
        accessResult
    ]);
    // If access is granted, render children normally
    if (accessResult.allowed) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
            children: children
        });
    }
    // Handle different display modes for denied access
    switch(mode){
        case 'hide':
            return fallback ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_jsxruntime.Fragment, {
                children: fallback
            }) : null;
        case 'disable':
            return /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Box, {
                sx: {
                    position: 'relative'
                },
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Box, {
                        sx: {
                            opacity: 0.5,
                            pointerEvents: 'none',
                            filter: 'grayscale(100%)'
                        },
                        children: children
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Box, {
                        sx: {
                            position: 'absolute',
                            top: 0,
                            right: 0,
                            p: 1
                        },
                        children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Chip, {
                            icon: /*#__PURE__*/ (0, _jsxruntime.jsx)(_Lock.default, {}),
                            label: `${accessResult.upgradeRequired?.toUpperCase()} Required`,
                            size: "small",
                            color: "default"
                        })
                    })
                ]
            });
        case 'overlay':
            return /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Box, {
                sx: {
                    position: 'relative'
                },
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Box, {
                        sx: {
                            opacity: 0.3,
                            pointerEvents: 'none',
                            filter: 'blur(2px)'
                        },
                        children: children
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Box, {
                        sx: {
                            position: 'absolute',
                            top: '50%',
                            left: '50%',
                            transform: 'translate(-50%, -50%)',
                            textAlign: 'center',
                            bgcolor: 'background.paper',
                            p: 2,
                            borderRadius: 2,
                            boxShadow: 3,
                            border: 1,
                            borderColor: 'divider'
                        },
                        children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Stack, {
                            spacing: 2,
                            alignItems: "center",
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_Lock.default, {
                                    color: "action",
                                    fontSize: "large"
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Typography, {
                                    variant: "h6",
                                    color: "text.secondary",
                                    children: [
                                        feature.replace(/_/g, ' ').replace(/\b\w/g, (l)=>l.toUpperCase()),
                                        " Locked"
                                    ]
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Typography, {
                                    variant: "body2",
                                    color: "text.secondary",
                                    children: formattedMessage
                                }),
                                showUpgradePrompt && accessResult.upgradeRequired && /*#__PURE__*/ (0, _jsxruntime.jsx)(_TierTransitionButton.default, {
                                    targetTier: accessResult.upgradeRequired,
                                    variant: "contained",
                                    size: "small"
                                })
                            ]
                        })
                    })
                ]
            });
        case 'alert':
        default:
            if (compact) {
                return /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Alert, {
                    severity: "info",
                    icon: /*#__PURE__*/ (0, _jsxruntime.jsx)(_Lock.default, {}),
                    action: showUpgradePrompt && accessResult.upgradeRequired ? /*#__PURE__*/ (0, _jsxruntime.jsx)(_TierTransitionButton.default, {
                        targetTier: accessResult.upgradeRequired,
                        variant: "outlined",
                        size: "small"
                    }) : undefined,
                    children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Typography, {
                        variant: "body2",
                        children: formattedMessage
                    })
                });
            }
            return /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Card, {
                sx: {
                    bgcolor: 'grey.50',
                    border: 1,
                    borderColor: 'grey.200'
                },
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.CardContent, {
                    children: /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Stack, {
                        spacing: 2,
                        children: [
                            /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Box, {
                                sx: {
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: 1
                                },
                                children: [
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_Lock.default, {
                                        color: "action"
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsxs)(_material.Typography, {
                                        variant: "h6",
                                        color: "text.secondary",
                                        children: [
                                            feature.replace(/_/g, ' ').replace(/\b\w/g, (l)=>l.toUpperCase()),
                                            " Not Available"
                                        ]
                                    }),
                                    /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Chip, {
                                        label: `Current: ${tier?.toUpperCase() || 'NONE'}`,
                                        size: "small",
                                        variant: "outlined"
                                    })
                                ]
                            }),
                            /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Typography, {
                                variant: "body2",
                                color: "text.secondary",
                                children: formattedMessage
                            }),
                            showUpgradePrompt && accessResult.upgradeRequired && /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Box, {
                                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(_TierTransitionButton.default, {
                                    targetTier: accessResult.upgradeRequired,
                                    variant: "contained"
                                })
                            })
                        ]
                    })
                })
            });
    }
});
FeatureGate.displayName = 'FeatureGate';
const _default = FeatureGate;
function useFeatureGate(feature) {
    const { canAccessFeature } = (0, _useSubscription.useSubscription)();
    return canAccessFeature(feature);
}
function FeatureAvailabilityChip({ feature, showLabel = true }) {
    const { canAccessFeature } = (0, _useSubscription.useSubscription)();
    const result = canAccessFeature(feature);
    const label = showLabel ? feature.replace(/_/g, ' ').replace(/\b\w/g, (l)=>l.toUpperCase()) : '';
    if (result.allowed) {
        return /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Chip, {
            icon: /*#__PURE__*/ (0, _jsxruntime.jsx)(_CheckCircle.default, {}),
            label: label || 'Available',
            color: "success",
            size: "small",
            variant: "filled"
        });
    }
    return /*#__PURE__*/ (0, _jsxruntime.jsx)(_material.Chip, {
        icon: /*#__PURE__*/ (0, _jsxruntime.jsx)(_Lock.default, {}),
        label: label || `${result.upgradeRequired?.toUpperCase()} Required`,
        color: "default",
        size: "small",
        variant: "outlined"
    });
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxyZXBvc1xcZmFtaWx5LW9yaWVudGVkXFxzcmNcXHNoYXJlZFxcY29tcG9uZW50c1xcZ2F0ZXNcXEZlYXR1cmVHYXRlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRmVhdHVyZUdhdGUgQ29tcG9uZW50XHJcbiAqIENvbmRpdGlvbmFsbHkgcmVuZGVycyBjb250ZW50IGJhc2VkIG9uIHN1YnNjcmlwdGlvbiB0aWVyIGFuZCBmZWF0dXJlIGFjY2Vzc1xyXG4gKiBQcm92aWRlcyB1cGdyYWRlIHByb21wdHMgZm9yIGxvY2tlZCBmZWF0dXJlc1xyXG4gKi9cclxuXHJcbid1c2UgY2xpZW50JztcclxuXHJcbmltcG9ydCBSZWFjdCwgeyBSZWFjdE5vZGUsIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7XHJcbiAgQm94LFxyXG4gIEFsZXJ0LFxyXG4gIENhcmQsXHJcbiAgQ2FyZENvbnRlbnQsXHJcbiAgVHlwb2dyYXBoeSxcclxuICBDaGlwLFxyXG4gIFN0YWNrXHJcbn0gZnJvbSAnQG11aS9tYXRlcmlhbCc7XHJcbmltcG9ydCB7IFxyXG4gIExvY2ssXHJcbiAgQ2hlY2tDaXJjbGUgXHJcbn0gZnJvbSAnQG11aS9pY29ucy1tYXRlcmlhbCc7XHJcbmltcG9ydCB7IHVzZVN1YnNjcmlwdGlvbiB9IGZyb20gJ0AvaG9va3MvdXNlU3Vic2NyaXB0aW9uJztcclxuaW1wb3J0IHsgdHlwZSBTdWJzY3JpcHRpb25GZWF0dXJlIH0gZnJvbSAnQC91dGlscy9zdWJzY3JpcHRpb25TZXJ2aWNlJztcclxuaW1wb3J0IFRpZXJUcmFuc2l0aW9uQnV0dG9uIGZyb20gJ0AvZmVhdHVyZXMvc3Vic2NyaXB0aW9uL2NvbXBvbmVudHMvVGllclRyYW5zaXRpb25CdXR0b24nO1xyXG5cclxuaW50ZXJmYWNlIEZlYXR1cmVHYXRlUHJvcHMge1xyXG4gIGZlYXR1cmU6IFN1YnNjcmlwdGlvbkZlYXR1cmU7XHJcbiAgY2hpbGRyZW46IFJlYWN0Tm9kZTtcclxuICBmYWxsYmFjaz86IFJlYWN0Tm9kZTtcclxuICBzaG93VXBncmFkZVByb21wdD86IGJvb2xlYW47XHJcbiAgbW9kZT86ICdoaWRlJyB8ICdkaXNhYmxlJyB8ICdvdmVybGF5JyB8ICdhbGVydCc7XHJcbiAgY29tcGFjdD86IGJvb2xlYW47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBGZWF0dXJlIGdhdGUgY29tcG9uZW50IHdpdGggbXVsdGlwbGUgZGlzcGxheSBtb2Rlc1xyXG4gKi9cclxuY29uc3QgRmVhdHVyZUdhdGUgPSBSZWFjdC5tZW1vKCh7XHJcbiAgZmVhdHVyZSxcclxuICBjaGlsZHJlbixcclxuICBmYWxsYmFjayxcclxuICBzaG93VXBncmFkZVByb21wdCA9IHRydWUsXHJcbiAgbW9kZSA9ICdoaWRlJyxcclxuICBjb21wYWN0ID0gZmFsc2VcclxufTogRmVhdHVyZUdhdGVQcm9wcykgPT4ge1xyXG4gIGNvbnN0IHsgY2FuQWNjZXNzRmVhdHVyZSwgZm9ybWF0RmVhdHVyZU1lc3NhZ2UsIHRpZXIgfSA9IHVzZVN1YnNjcmlwdGlvbigpO1xyXG4gIFxyXG4gIC8vIE1lbW9pemUgYWNjZXNzIHJlc3VsdCB0byBwcmV2ZW50IHVubmVjZXNzYXJ5IHJlLWNvbXB1dGF0aW9uXHJcbiAgY29uc3QgYWNjZXNzUmVzdWx0ID0gdXNlTWVtbygoKSA9PiB7XHJcbiAgICByZXR1cm4gY2FuQWNjZXNzRmVhdHVyZShmZWF0dXJlKTtcclxuICB9LCBbY2FuQWNjZXNzRmVhdHVyZSwgZmVhdHVyZV0pO1xyXG4gIFxyXG4gIC8vIE1lbW9pemUgZm9ybWF0dGVkIG1lc3NhZ2VcclxuICBjb25zdCBmb3JtYXR0ZWRNZXNzYWdlID0gdXNlTWVtbygoKSA9PiB7XHJcbiAgICByZXR1cm4gZm9ybWF0RmVhdHVyZU1lc3NhZ2UoYWNjZXNzUmVzdWx0KTtcclxuICB9LCBbZm9ybWF0RmVhdHVyZU1lc3NhZ2UsIGFjY2Vzc1Jlc3VsdF0pO1xyXG4gIFxyXG4gIC8vIElmIGFjY2VzcyBpcyBncmFudGVkLCByZW5kZXIgY2hpbGRyZW4gbm9ybWFsbHlcclxuICBpZiAoYWNjZXNzUmVzdWx0LmFsbG93ZWQpIHtcclxuICAgIHJldHVybiA8PntjaGlsZHJlbn08Lz47XHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgZGlmZmVyZW50IGRpc3BsYXkgbW9kZXMgZm9yIGRlbmllZCBhY2Nlc3NcclxuICBzd2l0Y2ggKG1vZGUpIHtcclxuICAgIGNhc2UgJ2hpZGUnOlxyXG4gICAgICByZXR1cm4gZmFsbGJhY2sgPyA8PntmYWxsYmFja308Lz4gOiBudWxsO1xyXG4gICAgICBcclxuICAgIGNhc2UgJ2Rpc2FibGUnOlxyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIDxCb3ggc3g9e3sgcG9zaXRpb246ICdyZWxhdGl2ZScgfX0+XHJcbiAgICAgICAgICA8Qm94IHN4PXt7IFxyXG4gICAgICAgICAgICBvcGFjaXR5OiAwLjUsIFxyXG4gICAgICAgICAgICBwb2ludGVyRXZlbnRzOiAnbm9uZScsXHJcbiAgICAgICAgICAgIGZpbHRlcjogJ2dyYXlzY2FsZSgxMDAlKSdcclxuICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICB7Y2hpbGRyZW59XHJcbiAgICAgICAgICA8L0JveD5cclxuICAgICAgICAgIDxCb3ggc3g9e3sgXHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLCBcclxuICAgICAgICAgICAgdG9wOiAwLCBcclxuICAgICAgICAgICAgcmlnaHQ6IDAsIFxyXG4gICAgICAgICAgICBwOiAxIFxyXG4gICAgICAgICAgfX0+XHJcbiAgICAgICAgICAgIDxDaGlwIFxyXG4gICAgICAgICAgICAgIGljb249ezxMb2NrIC8+fSBcclxuICAgICAgICAgICAgICBsYWJlbD17YCR7YWNjZXNzUmVzdWx0LnVwZ3JhZGVSZXF1aXJlZD8udG9VcHBlckNhc2UoKX0gUmVxdWlyZWRgfVxyXG4gICAgICAgICAgICAgIHNpemU9XCJzbWFsbFwiXHJcbiAgICAgICAgICAgICAgY29sb3I9XCJkZWZhdWx0XCJcclxuICAgICAgICAgICAgLz5cclxuICAgICAgICAgIDwvQm94PlxyXG4gICAgICAgIDwvQm94PlxyXG4gICAgICApO1xyXG4gICAgICBcclxuICAgIGNhc2UgJ292ZXJsYXknOlxyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIDxCb3ggc3g9e3sgcG9zaXRpb246ICdyZWxhdGl2ZScgfX0+XHJcbiAgICAgICAgICA8Qm94IHN4PXt7IFxyXG4gICAgICAgICAgICBvcGFjaXR5OiAwLjMsIFxyXG4gICAgICAgICAgICBwb2ludGVyRXZlbnRzOiAnbm9uZScsXHJcbiAgICAgICAgICAgIGZpbHRlcjogJ2JsdXIoMnB4KSdcclxuICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICB7Y2hpbGRyZW59XHJcbiAgICAgICAgICA8L0JveD5cclxuICAgICAgICAgIDxCb3ggc3g9e3tcclxuICAgICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXHJcbiAgICAgICAgICAgIHRvcDogJzUwJScsXHJcbiAgICAgICAgICAgIGxlZnQ6ICc1MCUnLFxyXG4gICAgICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGUoLTUwJSwgLTUwJSknLFxyXG4gICAgICAgICAgICB0ZXh0QWxpZ246ICdjZW50ZXInLFxyXG4gICAgICAgICAgICBiZ2NvbG9yOiAnYmFja2dyb3VuZC5wYXBlcicsXHJcbiAgICAgICAgICAgIHA6IDIsXHJcbiAgICAgICAgICAgIGJvcmRlclJhZGl1czogMixcclxuICAgICAgICAgICAgYm94U2hhZG93OiAzLFxyXG4gICAgICAgICAgICBib3JkZXI6IDEsXHJcbiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnZGl2aWRlcidcclxuICAgICAgICAgIH19PlxyXG4gICAgICAgICAgICA8U3RhY2sgc3BhY2luZz17Mn0gYWxpZ25JdGVtcz1cImNlbnRlclwiPlxyXG4gICAgICAgICAgICAgIDxMb2NrIGNvbG9yPVwiYWN0aW9uXCIgZm9udFNpemU9XCJsYXJnZVwiIC8+XHJcbiAgICAgICAgICAgICAgPFR5cG9ncmFwaHkgdmFyaWFudD1cImg2XCIgY29sb3I9XCJ0ZXh0LnNlY29uZGFyeVwiPlxyXG4gICAgICAgICAgICAgICAge2ZlYXR1cmUucmVwbGFjZSgvXy9nLCAnICcpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSl9IExvY2tlZFxyXG4gICAgICAgICAgICAgIDwvVHlwb2dyYXBoeT5cclxuICAgICAgICAgICAgICA8VHlwb2dyYXBoeSB2YXJpYW50PVwiYm9keTJcIiBjb2xvcj1cInRleHQuc2Vjb25kYXJ5XCI+XHJcbiAgICAgICAgICAgICAgICB7Zm9ybWF0dGVkTWVzc2FnZX1cclxuICAgICAgICAgICAgICA8L1R5cG9ncmFwaHk+XHJcbiAgICAgICAgICAgICAge3Nob3dVcGdyYWRlUHJvbXB0ICYmIGFjY2Vzc1Jlc3VsdC51cGdyYWRlUmVxdWlyZWQgJiYgKFxyXG4gICAgICAgICAgICAgICAgPFRpZXJUcmFuc2l0aW9uQnV0dG9uIFxyXG4gICAgICAgICAgICAgICAgICB0YXJnZXRUaWVyPXthY2Nlc3NSZXN1bHQudXBncmFkZVJlcXVpcmVkfVxyXG4gICAgICAgICAgICAgICAgICB2YXJpYW50PVwiY29udGFpbmVkXCJcclxuICAgICAgICAgICAgICAgICAgc2l6ZT1cInNtYWxsXCJcclxuICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgPC9TdGFjaz5cclxuICAgICAgICAgIDwvQm94PlxyXG4gICAgICAgIDwvQm94PlxyXG4gICAgICApO1xyXG4gICAgICBcclxuICAgIGNhc2UgJ2FsZXJ0JzpcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIGlmIChjb21wYWN0KSB7XHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgIDxBbGVydCBcclxuICAgICAgICAgICAgc2V2ZXJpdHk9XCJpbmZvXCIgXHJcbiAgICAgICAgICAgIGljb249ezxMb2NrIC8+fVxyXG4gICAgICAgICAgICBhY3Rpb249e1xyXG4gICAgICAgICAgICAgIHNob3dVcGdyYWRlUHJvbXB0ICYmIGFjY2Vzc1Jlc3VsdC51cGdyYWRlUmVxdWlyZWQgPyAoXHJcbiAgICAgICAgICAgICAgICA8VGllclRyYW5zaXRpb25CdXR0b24gXHJcbiAgICAgICAgICAgICAgICAgIHRhcmdldFRpZXI9e2FjY2Vzc1Jlc3VsdC51cGdyYWRlUmVxdWlyZWR9XHJcbiAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lZFwiXHJcbiAgICAgICAgICAgICAgICAgIHNpemU9XCJzbWFsbFwiXHJcbiAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICkgOiB1bmRlZmluZWRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgPlxyXG4gICAgICAgICAgICA8VHlwb2dyYXBoeSB2YXJpYW50PVwiYm9keTJcIj5cclxuICAgICAgICAgICAgICB7Zm9ybWF0dGVkTWVzc2FnZX1cclxuICAgICAgICAgICAgPC9UeXBvZ3JhcGh5PlxyXG4gICAgICAgICAgPC9BbGVydD5cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIDxDYXJkIHN4PXt7IGJnY29sb3I6ICdncmV5LjUwJywgYm9yZGVyOiAxLCBib3JkZXJDb2xvcjogJ2dyZXkuMjAwJyB9fT5cclxuICAgICAgICAgIDxDYXJkQ29udGVudD5cclxuICAgICAgICAgICAgPFN0YWNrIHNwYWNpbmc9ezJ9PlxyXG4gICAgICAgICAgICAgIDxCb3ggc3g9e3sgZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgZ2FwOiAxIH19PlxyXG4gICAgICAgICAgICAgICAgPExvY2sgY29sb3I9XCJhY3Rpb25cIiAvPlxyXG4gICAgICAgICAgICAgICAgPFR5cG9ncmFwaHkgdmFyaWFudD1cImg2XCIgY29sb3I9XCJ0ZXh0LnNlY29uZGFyeVwiPlxyXG4gICAgICAgICAgICAgICAgICB7ZmVhdHVyZS5yZXBsYWNlKC9fL2csICcgJykucmVwbGFjZSgvXFxiXFx3L2csIGwgPT4gbC50b1VwcGVyQ2FzZSgpKX0gTm90IEF2YWlsYWJsZVxyXG4gICAgICAgICAgICAgICAgPC9UeXBvZ3JhcGh5PlxyXG4gICAgICAgICAgICAgICAgPENoaXAgXHJcbiAgICAgICAgICAgICAgICAgIGxhYmVsPXtgQ3VycmVudDogJHt0aWVyPy50b1VwcGVyQ2FzZSgpIHx8ICdOT05FJ31gfVxyXG4gICAgICAgICAgICAgICAgICBzaXplPVwic21hbGxcIlxyXG4gICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZWRcIlxyXG4gICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICA8L0JveD5cclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICA8VHlwb2dyYXBoeSB2YXJpYW50PVwiYm9keTJcIiBjb2xvcj1cInRleHQuc2Vjb25kYXJ5XCI+XHJcbiAgICAgICAgICAgICAgICB7Zm9ybWF0dGVkTWVzc2FnZX1cclxuICAgICAgICAgICAgICA8L1R5cG9ncmFwaHk+XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAge3Nob3dVcGdyYWRlUHJvbXB0ICYmIGFjY2Vzc1Jlc3VsdC51cGdyYWRlUmVxdWlyZWQgJiYgKFxyXG4gICAgICAgICAgICAgICAgPEJveD5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRpZXJUcmFuc2l0aW9uQnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0VGllcj17YWNjZXNzUmVzdWx0LnVwZ3JhZGVSZXF1aXJlZH1cclxuICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwiY29udGFpbmVkXCJcclxuICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgIDwvQm94PlxyXG4gICAgICAgICAgICAgICl9XHJcbiAgICAgICAgICAgIDwvU3RhY2s+XHJcbiAgICAgICAgICA8L0NhcmRDb250ZW50PlxyXG4gICAgICAgIDwvQ2FyZD5cclxuICAgICAgKTtcclxuICB9XHJcbn0pO1xyXG5cclxuRmVhdHVyZUdhdGUuZGlzcGxheU5hbWUgPSAnRmVhdHVyZUdhdGUnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRmVhdHVyZUdhdGU7XHJcblxyXG4vKipcclxuICogU2ltcGxlIGZlYXR1cmUgY2hlY2tlciBob29rIGZvciBjb25kaXRpb25hbCByZW5kZXJpbmdcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB1c2VGZWF0dXJlR2F0ZShmZWF0dXJlOiBTdWJzY3JpcHRpb25GZWF0dXJlKSB7XHJcbiAgY29uc3QgeyBjYW5BY2Nlc3NGZWF0dXJlIH0gPSB1c2VTdWJzY3JpcHRpb24oKTtcclxuICByZXR1cm4gY2FuQWNjZXNzRmVhdHVyZShmZWF0dXJlKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZlYXR1cmUgYXZhaWxhYmlsaXR5IGluZGljYXRvciBjb21wb25lbnRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBGZWF0dXJlQXZhaWxhYmlsaXR5Q2hpcCh7IFxyXG4gIGZlYXR1cmUsIFxyXG4gIHNob3dMYWJlbCA9IHRydWUgXHJcbn06IHsgXHJcbiAgZmVhdHVyZTogU3Vic2NyaXB0aW9uRmVhdHVyZTtcclxuICBzaG93TGFiZWw/OiBib29sZWFuOyBcclxufSkge1xyXG4gIGNvbnN0IHsgY2FuQWNjZXNzRmVhdHVyZSB9ID0gdXNlU3Vic2NyaXB0aW9uKCk7XHJcbiAgY29uc3QgcmVzdWx0ID0gY2FuQWNjZXNzRmVhdHVyZShmZWF0dXJlKTtcclxuICBcclxuICBjb25zdCBsYWJlbCA9IHNob3dMYWJlbCA/IGZlYXR1cmUucmVwbGFjZSgvXy9nLCAnICcpLnJlcGxhY2UoL1xcYlxcdy9nLCBsID0+IGwudG9VcHBlckNhc2UoKSkgOiAnJztcclxuICBcclxuICBpZiAocmVzdWx0LmFsbG93ZWQpIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxDaGlwXHJcbiAgICAgICAgaWNvbj17PENoZWNrQ2lyY2xlIC8+fVxyXG4gICAgICAgIGxhYmVsPXtsYWJlbCB8fCAnQXZhaWxhYmxlJ31cclxuICAgICAgICBjb2xvcj1cInN1Y2Nlc3NcIlxyXG4gICAgICAgIHNpemU9XCJzbWFsbFwiXHJcbiAgICAgICAgdmFyaWFudD1cImZpbGxlZFwiXHJcbiAgICAgIC8+XHJcbiAgICApO1xyXG4gIH1cclxuICBcclxuICByZXR1cm4gKFxyXG4gICAgPENoaXBcclxuICAgICAgaWNvbj17PExvY2sgLz59XHJcbiAgICAgIGxhYmVsPXtsYWJlbCB8fCBgJHtyZXN1bHQudXBncmFkZVJlcXVpcmVkPy50b1VwcGVyQ2FzZSgpfSBSZXF1aXJlZGB9XHJcbiAgICAgIGNvbG9yPVwiZGVmYXVsdFwiXHJcbiAgICAgIHNpemU9XCJzbWFsbFwiXHJcbiAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lZFwiXHJcbiAgICAvPlxyXG4gICk7XHJcbn0gIl0sIm5hbWVzIjpbIkZlYXR1cmVBdmFpbGFiaWxpdHlDaGlwIiwidXNlRmVhdHVyZUdhdGUiLCJGZWF0dXJlR2F0ZSIsIlJlYWN0IiwibWVtbyIsImZlYXR1cmUiLCJjaGlsZHJlbiIsImZhbGxiYWNrIiwic2hvd1VwZ3JhZGVQcm9tcHQiLCJtb2RlIiwiY29tcGFjdCIsImNhbkFjY2Vzc0ZlYXR1cmUiLCJmb3JtYXRGZWF0dXJlTWVzc2FnZSIsInRpZXIiLCJ1c2VTdWJzY3JpcHRpb24iLCJhY2Nlc3NSZXN1bHQiLCJ1c2VNZW1vIiwiZm9ybWF0dGVkTWVzc2FnZSIsImFsbG93ZWQiLCJCb3giLCJzeCIsInBvc2l0aW9uIiwib3BhY2l0eSIsInBvaW50ZXJFdmVudHMiLCJmaWx0ZXIiLCJ0b3AiLCJyaWdodCIsInAiLCJDaGlwIiwiaWNvbiIsIkxvY2siLCJsYWJlbCIsInVwZ3JhZGVSZXF1aXJlZCIsInRvVXBwZXJDYXNlIiwic2l6ZSIsImNvbG9yIiwibGVmdCIsInRyYW5zZm9ybSIsInRleHRBbGlnbiIsImJnY29sb3IiLCJib3JkZXJSYWRpdXMiLCJib3hTaGFkb3ciLCJib3JkZXIiLCJib3JkZXJDb2xvciIsIlN0YWNrIiwic3BhY2luZyIsImFsaWduSXRlbXMiLCJmb250U2l6ZSIsIlR5cG9ncmFwaHkiLCJ2YXJpYW50IiwicmVwbGFjZSIsImwiLCJUaWVyVHJhbnNpdGlvbkJ1dHRvbiIsInRhcmdldFRpZXIiLCJBbGVydCIsInNldmVyaXR5IiwiYWN0aW9uIiwidW5kZWZpbmVkIiwiQ2FyZCIsIkNhcmRDb250ZW50IiwiZGlzcGxheSIsImdhcCIsImRpc3BsYXlOYW1lIiwic2hvd0xhYmVsIiwicmVzdWx0IiwiQ2hlY2tDaXJjbGUiXSwibWFwcGluZ3MiOiJBQUFBOzs7O0NBSUMsR0FFRDs7Ozs7Ozs7Ozs7O0lBNk1nQkEsdUJBQXVCO2VBQXZCQTs7SUFiaEIsT0FBMkI7ZUFBM0I7O0lBS2dCQyxjQUFjO2VBQWRBOzs7OytEQW5NMEI7MEJBU25DOzs7aUNBS3lCOzZFQUVDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVdqQzs7Q0FFQyxHQUNELE1BQU1DLDRCQUFjQyxjQUFLLENBQUNDLElBQUksQ0FBQyxDQUFDLEVBQzlCQyxPQUFPLEVBQ1BDLFFBQVEsRUFDUkMsUUFBUSxFQUNSQyxvQkFBb0IsSUFBSSxFQUN4QkMsT0FBTyxNQUFNLEVBQ2JDLFVBQVUsS0FBSyxFQUNFO0lBQ2pCLE1BQU0sRUFBRUMsZ0JBQWdCLEVBQUVDLG9CQUFvQixFQUFFQyxJQUFJLEVBQUUsR0FBR0MsSUFBQUEsZ0NBQWU7SUFFeEUsOERBQThEO0lBQzlELE1BQU1DLGVBQWVDLElBQUFBLGNBQU8sRUFBQztRQUMzQixPQUFPTCxpQkFBaUJOO0lBQzFCLEdBQUc7UUFBQ007UUFBa0JOO0tBQVE7SUFFOUIsNEJBQTRCO0lBQzVCLE1BQU1ZLG1CQUFtQkQsSUFBQUEsY0FBTyxFQUFDO1FBQy9CLE9BQU9KLHFCQUFxQkc7SUFDOUIsR0FBRztRQUFDSDtRQUFzQkc7S0FBYTtJQUV2QyxpREFBaUQ7SUFDakQsSUFBSUEsYUFBYUcsT0FBTyxFQUFFO1FBQ3hCLHFCQUFPO3NCQUFHWjs7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
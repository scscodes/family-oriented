9e8eca4a6fbb4c309d8a96546950e18e
/**
 * useSubscription Hook - React hook for subscription tier management
 * Provides subscription feature gating and usage limit checking
 */ "use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    useSubscription: function() {
        return useSubscription;
    },
    useUsageTracking: function() {
        return useUsageTracking;
    }
});
const _react = require("react");
const _UserContext = require("../context/UserContext");
const _subscriptionService = require("../utils/subscriptionService");
const _logger = require("../utils/logger");
function useSubscription() {
    const { org, avatars, loadingState } = (0, _UserContext.useUser)();
    // Memoize basic values to prevent unnecessary re-renders
    const subscriptionPlan = (0, _react.useMemo)(()=>org?.subscriptionPlan || null, [
        org?.subscriptionPlan
    ]);
    const tier = (0, _react.useMemo)(()=>subscriptionPlan?.tier || null, [
        subscriptionPlan?.tier
    ]);
    const isLoaded = (0, _react.useMemo)(()=>loadingState.isReady, [
        loadingState.isReady
    ]);
    // Removed debug logging to prevent excessive console output
    // Current usage calculations - memoized to prevent re-renders
    const currentUsage = (0, _react.useMemo)(()=>({
            avatarsCount: avatars?.length || 0,
            isLoadingUsage: loadingState.avatars
        }), [
        avatars?.length,
        loadingState.avatars
    ]);
    // Enhanced feature checking functions - memoized with stable dependencies
    const canAccessFeature = (0, _react.useCallback)((feature)=>{
        if (!isLoaded) {
            return {
                allowed: false,
                reason: 'Loading subscription information...'
            };
        }
        return _subscriptionService.SubscriptionService.canAccessFeature(subscriptionPlan, feature);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    const hasFeature = (0, _react.useCallback)((feature)=>{
        const result = canAccessFeature(feature);
        return result.allowed;
    }, [
        canAccessFeature
    ]);
    // Bulk feature checking for UI optimization
    const checkMultipleFeatures = (0, _react.useCallback)((features)=>{
        if (!isLoaded) {
            return features.reduce((acc, feature)=>{
                acc[feature] = {
                    allowed: false,
                    reason: 'Loading...'
                };
                return acc;
            }, {});
        }
        return _subscriptionService.SubscriptionService.checkMultipleFeatures(subscriptionPlan, features);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    // Enhanced usage checking with better error handling
    const canCreateAvatar = (0, _react.useCallback)(()=>{
        if (!isLoaded || currentUsage.isLoadingUsage) {
            return {
                allowed: false,
                reason: 'Loading avatar information...'
            };
        }
        const result = _subscriptionService.SubscriptionService.canCreateAvatar(subscriptionPlan, currentUsage.avatarsCount);
        // Only log when actually blocked to reduce spam
        if (!result.allowed) {
            _logger.logger.info('Avatar creation blocked by subscription limit:', {
                tier,
                currentCount: currentUsage.avatarsCount,
                limit: result.limit
            });
        }
        return result;
    }, [
        subscriptionPlan,
        currentUsage,
        isLoaded,
        tier
    ]);
    const canCreateCollection = (0, _react.useCallback)(()=>{
        if (!isLoaded) {
            return {
                allowed: false,
                reason: 'Loading subscription information...'
            };
        }
        // For now, we'll use a simplified check
        // In the future, we could fetch per-avatar collection counts
        const estimatedCollectionsCount = 5; // This would be fetched from database
        return _subscriptionService.SubscriptionService.canCreateCollection(subscriptionPlan, estimatedCollectionsCount);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    const checkUsageLimit = (0, _react.useCallback)((limitType, currentUsage)=>{
        if (!isLoaded) {
            return {
                allowed: false,
                reason: 'Loading subscription information...'
            };
        }
        return _subscriptionService.SubscriptionService.checkUsageLimit(subscriptionPlan, limitType, currentUsage);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    // Smart upgrade recommendations
    const getUpgradeRecommendation = (0, _react.useCallback)((lockedFeaturesAccessed = [])=>{
        if (!isLoaded) {
            return {
                recommended: false,
                targetTier: 'personal',
                reasons: [
                    'Loading...'
                ],
                benefits: [],
                urgency: 'low'
            };
        }
        const usageData = {
            avatarsCount: currentUsage.avatarsCount,
            collectionsCount: 5,
            sessionsThisMonth: 150,
            dataRetentionMonths: 12
        };
        return _subscriptionService.SubscriptionService.getSmartUpgradeRecommendation(subscriptionPlan, usageData, lockedFeaturesAccessed);
    }, [
        subscriptionPlan,
        isLoaded,
        currentUsage
    ]);
    // Get locked features for upgrade prompts
    const getLockedFeatures = (0, _react.useCallback)(()=>{
        if (!isLoaded) return [];
        return _subscriptionService.SubscriptionService.getLockedFeatures(subscriptionPlan);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    // Utility functions
    const getAvailableFeatures = (0, _react.useCallback)(()=>{
        if (!isLoaded) return [];
        return _subscriptionService.SubscriptionService.getAvailableFeatures(subscriptionPlan);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    const getUsageSummary = (0, _react.useCallback)((usageData)=>{
        if (!isLoaded) {
            return {};
        }
        return _subscriptionService.SubscriptionService.getUsageSummary(subscriptionPlan, usageData);
    }, [
        subscriptionPlan,
        isLoaded
    ]);
    const formatFeatureMessage = (0, _react.useCallback)((result)=>{
        return _subscriptionService.SubscriptionService.formatFeatureGateMessage(result);
    }, []);
    // Specific feature access shortcuts for common UI patterns - memoized to prevent re-renders
    const featureAccess = (0, _react.useMemo)(()=>({
            dashboard: canAccessFeature('analytics'),
            userManagement: canAccessFeature('user_management'),
            premiumThemes: canAccessFeature('premium_themes'),
            customBranding: canAccessFeature('custom_branding'),
            collections: canAccessFeature('collections'),
            scheduling: canAccessFeature('scheduling'),
            bulkOperations: canAccessFeature('bulk_operations'),
            apiAccess: canAccessFeature('api_access'),
            exportData: canAccessFeature('export_data'),
            advancedReporting: canAccessFeature('advanced_reporting')
        }), [
        canAccessFeature
    ]);
    // Return memoized hook result to prevent unnecessary re-renders
    return (0, _react.useMemo)(()=>({
            // Subscription plan info
            subscriptionPlan,
            tier,
            isLoaded,
            // Feature checking
            canAccessFeature,
            hasFeature,
            checkMultipleFeatures,
            // Usage checking
            canCreateAvatar,
            canCreateCollection,
            checkUsageLimit,
            // Smart recommendations
            getUpgradeRecommendation,
            getLockedFeatures,
            // Utility methods
            getAvailableFeatures,
            getUsageSummary,
            formatFeatureMessage,
            // Feature access shortcuts
            featureAccess,
            // Current usage
            currentUsage
        }), [
        subscriptionPlan,
        tier,
        isLoaded,
        canAccessFeature,
        hasFeature,
        checkMultipleFeatures,
        canCreateAvatar,
        canCreateCollection,
        checkUsageLimit,
        getUpgradeRecommendation,
        getLockedFeatures,
        getAvailableFeatures,
        getUsageSummary,
        formatFeatureMessage,
        featureAccess,
        currentUsage
    ]);
}
function useUsageTracking() {
    const { subscriptionPlan, currentUsage } = useSubscription();
    const trackUsage = (0, _react.useCallback)(async (action, metadata)=>{
        // Analytics tracking for subscription usage
        _logger.logger.info('Subscription usage tracked:', {
            action,
            tier: subscriptionPlan?.tier,
            currentAvatars: currentUsage.avatarsCount,
            metadata
        });
    // Here we could send to analytics service or external tracking
    }, [
        subscriptionPlan,
        currentUsage
    ]);
    return {
        trackUsage
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxyZXBvc1xcZmFtaWx5LW9yaWVudGVkXFxzcmNcXGhvb2tzXFx1c2VTdWJzY3JpcHRpb24udHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiB1c2VTdWJzY3JpcHRpb24gSG9vayAtIFJlYWN0IGhvb2sgZm9yIHN1YnNjcmlwdGlvbiB0aWVyIG1hbmFnZW1lbnRcclxuICogUHJvdmlkZXMgc3Vic2NyaXB0aW9uIGZlYXR1cmUgZ2F0aW5nIGFuZCB1c2FnZSBsaW1pdCBjaGVja2luZ1xyXG4gKi9cclxuXHJcbmltcG9ydCB7IHVzZU1lbW8sIHVzZUNhbGxiYWNrIH0gZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQgeyB1c2VVc2VyIH0gZnJvbSAnQC9jb250ZXh0L1VzZXJDb250ZXh0JztcclxuaW1wb3J0IHsgXHJcbiAgU3Vic2NyaXB0aW9uU2VydmljZSwgXHJcbiAgdHlwZSBTdWJzY3JpcHRpb25GZWF0dXJlLCBcclxuICB0eXBlIFN1YnNjcmlwdGlvblRpZXIsXHJcbiAgdHlwZSBVc2FnZUxpbWl0LCBcclxuICB0eXBlIEZlYXR1cmVHYXRlUmVzdWx0LFxyXG4gIHR5cGUgVXNhZ2VEYXRhXHJcbn0gZnJvbSAnQC91dGlscy9zdWJzY3JpcHRpb25TZXJ2aWNlJztcclxuXHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvdXRpbHMvbG9nZ2VyJztcclxuXHJcbi8qKlxyXG4gKiBIb29rIHJldHVybiB0eXBlIC0gRW5oYW5jZWQgd2l0aCBjb21wcmVoZW5zaXZlIHN1YnNjcmlwdGlvbiBtYW5hZ2VtZW50XHJcbiAqL1xyXG50eXBlIFVwZ3JhZGVSZWNvbW1lbmRhdGlvbiA9IHtcclxuICByZWNvbW1lbmRlZDogYm9vbGVhbjtcclxuICB0YXJnZXRUaWVyOiBTdWJzY3JpcHRpb25UaWVyO1xyXG4gIHJlYXNvbnM6IHN0cmluZ1tdO1xyXG4gIGJlbmVmaXRzOiBzdHJpbmdbXTtcclxuICB1cmdlbmN5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnO1xyXG59O1xyXG5cclxuaW50ZXJmYWNlIFVzZVN1YnNjcmlwdGlvblJldHVybiB7XHJcbiAgLy8gU3Vic2NyaXB0aW9uIHBsYW4gaW5mb1xyXG4gIHN1YnNjcmlwdGlvblBsYW46IHtcclxuICAgIGlkOiBzdHJpbmc7XHJcbiAgICB0aWVyOiBzdHJpbmc7XHJcbiAgICBhdmF0YXJfbGltaXQ6IG51bWJlcjtcclxuICAgIGZlYXR1cmVzX2luY2x1ZGVkOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcclxuICB9IHwgbnVsbDtcclxuICB0aWVyOiBzdHJpbmcgfCBudWxsO1xyXG4gIGlzTG9hZGVkOiBib29sZWFuO1xyXG4gIFxyXG4gIC8vIEZlYXR1cmUgY2hlY2tpbmdcclxuICBjYW5BY2Nlc3NGZWF0dXJlOiAoZmVhdHVyZTogU3Vic2NyaXB0aW9uRmVhdHVyZSkgPT4gRmVhdHVyZUdhdGVSZXN1bHQ7XHJcbiAgaGFzRmVhdHVyZTogKGZlYXR1cmU6IFN1YnNjcmlwdGlvbkZlYXR1cmUpID0+IGJvb2xlYW47XHJcbiAgY2hlY2tNdWx0aXBsZUZlYXR1cmVzOiAoZmVhdHVyZXM6IFN1YnNjcmlwdGlvbkZlYXR1cmVbXSkgPT4gUmVjb3JkPFN1YnNjcmlwdGlvbkZlYXR1cmUsIEZlYXR1cmVHYXRlUmVzdWx0PjtcclxuICBcclxuICAvLyBVc2FnZSBjaGVja2luZ1xyXG4gIGNhbkNyZWF0ZUF2YXRhcjogKCkgPT4gRmVhdHVyZUdhdGVSZXN1bHQ7XHJcbiAgY2FuQ3JlYXRlQ29sbGVjdGlvbjogKGF2YXRhcklkPzogc3RyaW5nKSA9PiBGZWF0dXJlR2F0ZVJlc3VsdDtcclxuICBjaGVja1VzYWdlTGltaXQ6IChsaW1pdFR5cGU6IFVzYWdlTGltaXQsIGN1cnJlbnRVc2FnZTogbnVtYmVyKSA9PiBGZWF0dXJlR2F0ZVJlc3VsdDtcclxuICBcclxuICAvLyBTbWFydCByZWNvbW1lbmRhdGlvbnNcclxuICBnZXRVcGdyYWRlUmVjb21tZW5kYXRpb246IChsb2NrZWRGZWF0dXJlc0FjY2Vzc2VkPzogU3Vic2NyaXB0aW9uRmVhdHVyZVtdKSA9PiBVcGdyYWRlUmVjb21tZW5kYXRpb247XHJcbiAgZ2V0TG9ja2VkRmVhdHVyZXM6ICgpID0+IFN1YnNjcmlwdGlvbkZlYXR1cmVbXTtcclxuICBcclxuICAvLyBVdGlsaXR5IG1ldGhvZHNcclxuICBnZXRBdmFpbGFibGVGZWF0dXJlczogKCkgPT4gU3Vic2NyaXB0aW9uRmVhdHVyZVtdO1xyXG4gIGdldFVzYWdlU3VtbWFyeTogKHVzYWdlRGF0YTogVXNhZ2VEYXRhKSA9PiBSZWNvcmQ8VXNhZ2VMaW1pdCwgRmVhdHVyZUdhdGVSZXN1bHQ+O1xyXG4gIGZvcm1hdEZlYXR1cmVNZXNzYWdlOiAocmVzdWx0OiBGZWF0dXJlR2F0ZVJlc3VsdCkgPT4gc3RyaW5nO1xyXG4gIFxyXG4gIC8vIEZlYXR1cmUgYWNjZXNzIHNob3J0Y3V0cyBmb3IgY29tbW9uIFVJIHBhdHRlcm5zXHJcbiAgZmVhdHVyZUFjY2Vzczoge1xyXG4gICAgZGFzaGJvYXJkOiBGZWF0dXJlR2F0ZVJlc3VsdDtcclxuICAgIHVzZXJNYW5hZ2VtZW50OiBGZWF0dXJlR2F0ZVJlc3VsdDtcclxuICAgIHByZW1pdW1UaGVtZXM6IEZlYXR1cmVHYXRlUmVzdWx0O1xyXG4gICAgY3VzdG9tQnJhbmRpbmc6IEZlYXR1cmVHYXRlUmVzdWx0O1xyXG4gICAgY29sbGVjdGlvbnM6IEZlYXR1cmVHYXRlUmVzdWx0O1xyXG4gICAgc2NoZWR1bGluZzogRmVhdHVyZUdhdGVSZXN1bHQ7XHJcbiAgICBidWxrT3BlcmF0aW9uczogRmVhdHVyZUdhdGVSZXN1bHQ7XHJcbiAgICBhcGlBY2Nlc3M6IEZlYXR1cmVHYXRlUmVzdWx0O1xyXG4gICAgZXhwb3J0RGF0YTogRmVhdHVyZUdhdGVSZXN1bHQ7XHJcbiAgICBhZHZhbmNlZFJlcG9ydGluZzogRmVhdHVyZUdhdGVSZXN1bHQ7XHJcbiAgfTtcclxuICBcclxuICAvLyBDdXJyZW50IHVzYWdlIGRhdGFcclxuICBjdXJyZW50VXNhZ2U6IHtcclxuICAgIGF2YXRhcnNDb3VudDogbnVtYmVyO1xyXG4gICAgaXNMb2FkaW5nVXNhZ2U6IGJvb2xlYW47XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEVuaGFuY2VkIHN1YnNjcmlwdGlvbiBtYW5hZ2VtZW50IGhvb2sgd2l0aCBjb21wcmVoZW5zaXZlIGZlYXR1cmUgZ2F0aW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdXNlU3Vic2NyaXB0aW9uKCk6IFVzZVN1YnNjcmlwdGlvblJldHVybiB7XHJcbiAgY29uc3QgeyBvcmcsIGF2YXRhcnMsIGxvYWRpbmdTdGF0ZSB9ID0gdXNlVXNlcigpO1xyXG4gIFxyXG4gIC8vIE1lbW9pemUgYmFzaWMgdmFsdWVzIHRvIHByZXZlbnQgdW5uZWNlc3NhcnkgcmUtcmVuZGVyc1xyXG4gIGNvbnN0IHN1YnNjcmlwdGlvblBsYW4gPSB1c2VNZW1vKCgpID0+IG9yZz8uc3Vic2NyaXB0aW9uUGxhbiB8fCBudWxsLCBbb3JnPy5zdWJzY3JpcHRpb25QbGFuXSk7XHJcbiAgY29uc3QgdGllciA9IHVzZU1lbW8oKCkgPT4gc3Vic2NyaXB0aW9uUGxhbj8udGllciB8fCBudWxsLCBbc3Vic2NyaXB0aW9uUGxhbj8udGllcl0pO1xyXG4gIGNvbnN0IGlzTG9hZGVkID0gdXNlTWVtbygoKSA9PiBsb2FkaW5nU3RhdGUuaXNSZWFkeSwgW2xvYWRpbmdTdGF0ZS5pc1JlYWR5XSk7XHJcblxyXG4gIC8vIFJlbW92ZWQgZGVidWcgbG9nZ2luZyB0byBwcmV2ZW50IGV4Y2Vzc2l2ZSBjb25zb2xlIG91dHB1dFxyXG4gIFxyXG4gIC8vIEN1cnJlbnQgdXNhZ2UgY2FsY3VsYXRpb25zIC0gbWVtb2l6ZWQgdG8gcHJldmVudCByZS1yZW5kZXJzXHJcbiAgY29uc3QgY3VycmVudFVzYWdlID0gdXNlTWVtbygoKSA9PiAoe1xyXG4gICAgYXZhdGFyc0NvdW50OiBhdmF0YXJzPy5sZW5ndGggfHwgMCxcclxuICAgIGlzTG9hZGluZ1VzYWdlOiBsb2FkaW5nU3RhdGUuYXZhdGFyc1xyXG4gIH0pLCBbYXZhdGFycz8ubGVuZ3RoLCBsb2FkaW5nU3RhdGUuYXZhdGFyc10pO1xyXG5cclxuICAvLyBFbmhhbmNlZCBmZWF0dXJlIGNoZWNraW5nIGZ1bmN0aW9ucyAtIG1lbW9pemVkIHdpdGggc3RhYmxlIGRlcGVuZGVuY2llc1xyXG4gIGNvbnN0IGNhbkFjY2Vzc0ZlYXR1cmUgPSB1c2VDYWxsYmFjaygoZmVhdHVyZTogU3Vic2NyaXB0aW9uRmVhdHVyZSk6IEZlYXR1cmVHYXRlUmVzdWx0ID0+IHtcclxuICAgIGlmICghaXNMb2FkZWQpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246ICdMb2FkaW5nIHN1YnNjcmlwdGlvbiBpbmZvcm1hdGlvbi4uLidcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIFN1YnNjcmlwdGlvblNlcnZpY2UuY2FuQWNjZXNzRmVhdHVyZShzdWJzY3JpcHRpb25QbGFuLCBmZWF0dXJlKTtcclxuICB9LCBbc3Vic2NyaXB0aW9uUGxhbiwgaXNMb2FkZWRdKTtcclxuXHJcbiAgY29uc3QgaGFzRmVhdHVyZSA9IHVzZUNhbGxiYWNrKChmZWF0dXJlOiBTdWJzY3JpcHRpb25GZWF0dXJlKTogYm9vbGVhbiA9PiB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBjYW5BY2Nlc3NGZWF0dXJlKGZlYXR1cmUpO1xyXG4gICAgcmV0dXJuIHJlc3VsdC5hbGxvd2VkO1xyXG4gIH0sIFtjYW5BY2Nlc3NGZWF0dXJlXSk7XHJcblxyXG4gIC8vIEJ1bGsgZmVhdHVyZSBjaGVja2luZyBmb3IgVUkgb3B0aW1pemF0aW9uXHJcbiAgY29uc3QgY2hlY2tNdWx0aXBsZUZlYXR1cmVzID0gdXNlQ2FsbGJhY2soKGZlYXR1cmVzOiBTdWJzY3JpcHRpb25GZWF0dXJlW10pID0+IHtcclxuICAgIGlmICghaXNMb2FkZWQpIHtcclxuICAgICAgcmV0dXJuIGZlYXR1cmVzLnJlZHVjZSgoYWNjLCBmZWF0dXJlKSA9PiB7XHJcbiAgICAgICAgYWNjW2ZlYXR1cmVdID0geyBhbGxvd2VkOiBmYWxzZSwgcmVhc29uOiAnTG9hZGluZy4uLicgfTtcclxuICAgICAgICByZXR1cm4gYWNjO1xyXG4gICAgICB9LCB7fSBhcyBSZWNvcmQ8U3Vic2NyaXB0aW9uRmVhdHVyZSwgRmVhdHVyZUdhdGVSZXN1bHQ+KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIFN1YnNjcmlwdGlvblNlcnZpY2UuY2hlY2tNdWx0aXBsZUZlYXR1cmVzKHN1YnNjcmlwdGlvblBsYW4sIGZlYXR1cmVzKTtcclxuICB9LCBbc3Vic2NyaXB0aW9uUGxhbiwgaXNMb2FkZWRdKTtcclxuXHJcbiAgLy8gRW5oYW5jZWQgdXNhZ2UgY2hlY2tpbmcgd2l0aCBiZXR0ZXIgZXJyb3IgaGFuZGxpbmdcclxuICBjb25zdCBjYW5DcmVhdGVBdmF0YXIgPSB1c2VDYWxsYmFjaygoKTogRmVhdHVyZUdhdGVSZXN1bHQgPT4ge1xyXG4gICAgaWYgKCFpc0xvYWRlZCB8fCBjdXJyZW50VXNhZ2UuaXNMb2FkaW5nVXNhZ2UpIHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBhbGxvd2VkOiBmYWxzZSxcclxuICAgICAgICByZWFzb246ICdMb2FkaW5nIGF2YXRhciBpbmZvcm1hdGlvbi4uLidcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcmVzdWx0ID0gU3Vic2NyaXB0aW9uU2VydmljZS5jYW5DcmVhdGVBdmF0YXIoc3Vic2NyaXB0aW9uUGxhbiwgY3VycmVudFVzYWdlLmF2YXRhcnNDb3VudCk7XHJcbiAgICBcclxuICAgIC8vIE9ubHkgbG9nIHdoZW4gYWN0dWFsbHkgYmxvY2tlZCB0byByZWR1Y2Ugc3BhbVxyXG4gICAgaWYgKCFyZXN1bHQuYWxsb3dlZCkge1xyXG4gICAgICBsb2dnZXIuaW5mbygnQXZhdGFyIGNyZWF0aW9uIGJsb2NrZWQgYnkgc3Vic2NyaXB0aW9uIGxpbWl0OicsIHtcclxuICAgICAgICB0aWVyLFxyXG4gICAgICAgIGN1cnJlbnRDb3VudDogY3VycmVudFVzYWdlLmF2YXRhcnNDb3VudCxcclxuICAgICAgICBsaW1pdDogcmVzdWx0LmxpbWl0XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0sIFtzdWJzY3JpcHRpb25QbGFuLCBjdXJyZW50VXNhZ2UsIGlzTG9hZGVkLCB0aWVyXSk7XHJcblxyXG4gIGNvbnN0IGNhbkNyZWF0ZUNvbGxlY3Rpb24gPSB1c2VDYWxsYmFjaygoKTogRmVhdHVyZUdhdGVSZXN1bHQgPT4ge1xyXG4gICAgaWYgKCFpc0xvYWRlZCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogJ0xvYWRpbmcgc3Vic2NyaXB0aW9uIGluZm9ybWF0aW9uLi4uJ1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBGb3Igbm93LCB3ZSdsbCB1c2UgYSBzaW1wbGlmaWVkIGNoZWNrXHJcbiAgICAvLyBJbiB0aGUgZnV0dXJlLCB3ZSBjb3VsZCBmZXRjaCBwZXItYXZhdGFyIGNvbGxlY3Rpb24gY291bnRzXHJcbiAgICBjb25zdCBlc3RpbWF0ZWRDb2xsZWN0aW9uc0NvdW50ID0gNTsgLy8gVGhpcyB3b3VsZCBiZSBmZXRjaGVkIGZyb20gZGF0YWJhc2VcclxuICAgIFxyXG4gICAgcmV0dXJuIFN1YnNjcmlwdGlvblNlcnZpY2UuY2FuQ3JlYXRlQ29sbGVjdGlvbihzdWJzY3JpcHRpb25QbGFuLCBlc3RpbWF0ZWRDb2xsZWN0aW9uc0NvdW50KTtcclxuICB9LCBbc3Vic2NyaXB0aW9uUGxhbiwgaXNMb2FkZWRdKTtcclxuXHJcbiAgY29uc3QgY2hlY2tVc2FnZUxpbWl0ID0gdXNlQ2FsbGJhY2soKFxyXG4gICAgbGltaXRUeXBlOiBVc2FnZUxpbWl0LCBcclxuICAgIGN1cnJlbnRVc2FnZTogbnVtYmVyXHJcbiAgKTogRmVhdHVyZUdhdGVSZXN1bHQgPT4ge1xyXG4gICAgaWYgKCFpc0xvYWRlZCkge1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxyXG4gICAgICAgIHJlYXNvbjogJ0xvYWRpbmcgc3Vic2NyaXB0aW9uIGluZm9ybWF0aW9uLi4uJ1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gU3Vic2NyaXB0aW9uU2VydmljZS5jaGVja1VzYWdlTGltaXQoc3Vic2NyaXB0aW9uUGxhbiwgbGltaXRUeXBlLCBjdXJyZW50VXNhZ2UpO1xyXG4gIH0sIFtzdWJzY3JpcHRpb25QbGFuLCBpc0xvYWRlZF0pO1xyXG5cclxuICAvLyBTbWFydCB1cGdyYWRlIHJlY29tbWVuZGF0aW9uc1xyXG4gIGNvbnN0IGdldFVwZ3JhZGVSZWNvbW1lbmRhdGlvbiA9IHVzZUNhbGxiYWNrKChcclxuICAgIGxvY2tlZEZlYXR1cmVzQWNjZXNzZWQ6IFN1YnNjcmlwdGlvbkZlYXR1cmVbXSA9IFtdXHJcbiAgKSA9PiB7XHJcbiAgICBpZiAoIWlzTG9hZGVkKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVjb21tZW5kZWQ6IGZhbHNlLFxyXG4gICAgICAgIHRhcmdldFRpZXI6ICdwZXJzb25hbCcgYXMgU3Vic2NyaXB0aW9uVGllcixcclxuICAgICAgICByZWFzb25zOiBbJ0xvYWRpbmcuLi4nXSxcclxuICAgICAgICBiZW5lZml0czogW10sXHJcbiAgICAgICAgdXJnZW5jeTogJ2xvdycgYXMgY29uc3RcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgdXNhZ2VEYXRhID0ge1xyXG4gICAgICBhdmF0YXJzQ291bnQ6IGN1cnJlbnRVc2FnZS5hdmF0YXJzQ291bnQsXHJcbiAgICAgIGNvbGxlY3Rpb25zQ291bnQ6IDUsIC8vIFRoaXMgd291bGQgY29tZSBmcm9tIGFjdHVhbCBkYXRhXHJcbiAgICAgIHNlc3Npb25zVGhpc01vbnRoOiAxNTAsIC8vIFRoaXMgd291bGQgY29tZSBmcm9tIGFuYWx5dGljc1xyXG4gICAgICBkYXRhUmV0ZW50aW9uTW9udGhzOiAxMlxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuIFN1YnNjcmlwdGlvblNlcnZpY2UuZ2V0U21hcnRVcGdyYWRlUmVjb21tZW5kYXRpb24oXHJcbiAgICAgIHN1YnNjcmlwdGlvblBsYW4sXHJcbiAgICAgIHVzYWdlRGF0YSxcclxuICAgICAgbG9ja2VkRmVhdHVyZXNBY2Nlc3NlZFxyXG4gICAgKTtcclxuICB9LCBbc3Vic2NyaXB0aW9uUGxhbiwgaXNMb2FkZWQsIGN1cnJlbnRVc2FnZV0pO1xyXG5cclxuICAvLyBHZXQgbG9ja2VkIGZlYXR1cmVzIGZvciB1cGdyYWRlIHByb21wdHNcclxuICBjb25zdCBnZXRMb2NrZWRGZWF0dXJlcyA9IHVzZUNhbGxiYWNrKCgpOiBTdWJzY3JpcHRpb25GZWF0dXJlW10gPT4ge1xyXG4gICAgaWYgKCFpc0xvYWRlZCkgcmV0dXJuIFtdO1xyXG4gICAgcmV0dXJuIFN1YnNjcmlwdGlvblNlcnZpY2UuZ2V0TG9ja2VkRmVhdHVyZXMoc3Vic2NyaXB0aW9uUGxhbik7XHJcbiAgfSwgW3N1YnNjcmlwdGlvblBsYW4sIGlzTG9hZGVkXSk7XHJcblxyXG4gIC8vIFV0aWxpdHkgZnVuY3Rpb25zXHJcbiAgY29uc3QgZ2V0QXZhaWxhYmxlRmVhdHVyZXMgPSB1c2VDYWxsYmFjaygoKTogU3Vic2NyaXB0aW9uRmVhdHVyZVtdID0+IHtcclxuICAgIGlmICghaXNMb2FkZWQpIHJldHVybiBbXTtcclxuICAgIHJldHVybiBTdWJzY3JpcHRpb25TZXJ2aWNlLmdldEF2YWlsYWJsZUZlYXR1cmVzKHN1YnNjcmlwdGlvblBsYW4pO1xyXG4gIH0sIFtzdWJzY3JpcHRpb25QbGFuLCBpc0xvYWRlZF0pO1xyXG5cclxuICBjb25zdCBnZXRVc2FnZVN1bW1hcnkgPSB1c2VDYWxsYmFjaygodXNhZ2VEYXRhOiBVc2FnZURhdGEpID0+IHtcclxuICAgIGlmICghaXNMb2FkZWQpIHtcclxuICAgICAgcmV0dXJuIHt9IGFzIFJlY29yZDxVc2FnZUxpbWl0LCBGZWF0dXJlR2F0ZVJlc3VsdD47XHJcbiAgICB9XHJcbiAgICByZXR1cm4gU3Vic2NyaXB0aW9uU2VydmljZS5nZXRVc2FnZVN1bW1hcnkoc3Vic2NyaXB0aW9uUGxhbiwgdXNhZ2VEYXRhKTtcclxuICB9LCBbc3Vic2NyaXB0aW9uUGxhbiwgaXNMb2FkZWRdKTtcclxuXHJcbiAgY29uc3QgZm9ybWF0RmVhdHVyZU1lc3NhZ2UgPSB1c2VDYWxsYmFjaygoXHJcbiAgICByZXN1bHQ6IEZlYXR1cmVHYXRlUmVzdWx0XHJcbiAgKTogc3RyaW5nID0+IHtcclxuICAgIHJldHVybiBTdWJzY3JpcHRpb25TZXJ2aWNlLmZvcm1hdEZlYXR1cmVHYXRlTWVzc2FnZShyZXN1bHQpO1xyXG4gIH0sIFtdKTtcclxuXHJcbiAgLy8gU3BlY2lmaWMgZmVhdHVyZSBhY2Nlc3Mgc2hvcnRjdXRzIGZvciBjb21tb24gVUkgcGF0dGVybnMgLSBtZW1vaXplZCB0byBwcmV2ZW50IHJlLXJlbmRlcnNcclxuICBjb25zdCBmZWF0dXJlQWNjZXNzID0gdXNlTWVtbygoKSA9PiAoe1xyXG4gICAgZGFzaGJvYXJkOiBjYW5BY2Nlc3NGZWF0dXJlKCdhbmFseXRpY3MnKSxcclxuICAgIHVzZXJNYW5hZ2VtZW50OiBjYW5BY2Nlc3NGZWF0dXJlKCd1c2VyX21hbmFnZW1lbnQnKSxcclxuICAgIHByZW1pdW1UaGVtZXM6IGNhbkFjY2Vzc0ZlYXR1cmUoJ3ByZW1pdW1fdGhlbWVzJyksXHJcbiAgICBjdXN0b21CcmFuZGluZzogY2FuQWNjZXNzRmVhdHVyZSgnY3VzdG9tX2JyYW5kaW5nJyksXHJcbiAgICBjb2xsZWN0aW9uczogY2FuQWNjZXNzRmVhdHVyZSgnY29sbGVjdGlvbnMnKSxcclxuICAgIHNjaGVkdWxpbmc6IGNhbkFjY2Vzc0ZlYXR1cmUoJ3NjaGVkdWxpbmcnKSxcclxuICAgIGJ1bGtPcGVyYXRpb25zOiBjYW5BY2Nlc3NGZWF0dXJlKCdidWxrX29wZXJhdGlvbnMnKSxcclxuICAgIGFwaUFjY2VzczogY2FuQWNjZXNzRmVhdHVyZSgnYXBpX2FjY2VzcycpLFxyXG4gICAgZXhwb3J0RGF0YTogY2FuQWNjZXNzRmVhdHVyZSgnZXhwb3J0X2RhdGEnKSxcclxuICAgIGFkdmFuY2VkUmVwb3J0aW5nOiBjYW5BY2Nlc3NGZWF0dXJlKCdhZHZhbmNlZF9yZXBvcnRpbmcnKVxyXG4gIH0pLCBbY2FuQWNjZXNzRmVhdHVyZV0pO1xyXG5cclxuICAvLyBSZXR1cm4gbWVtb2l6ZWQgaG9vayByZXN1bHQgdG8gcHJldmVudCB1bm5lY2Vzc2FyeSByZS1yZW5kZXJzXHJcbiAgcmV0dXJuIHVzZU1lbW8oKCkgPT4gKHtcclxuICAgIC8vIFN1YnNjcmlwdGlvbiBwbGFuIGluZm9cclxuICAgIHN1YnNjcmlwdGlvblBsYW4sXHJcbiAgICB0aWVyLFxyXG4gICAgaXNMb2FkZWQsXHJcbiAgICBcclxuICAgIC8vIEZlYXR1cmUgY2hlY2tpbmdcclxuICAgIGNhbkFjY2Vzc0ZlYXR1cmUsXHJcbiAgICBoYXNGZWF0dXJlLFxyXG4gICAgY2hlY2tNdWx0aXBsZUZlYXR1cmVzLFxyXG4gICAgXHJcbiAgICAvLyBVc2FnZSBjaGVja2luZ1xyXG4gICAgY2FuQ3JlYXRlQXZhdGFyLFxyXG4gICAgY2FuQ3JlYXRlQ29sbGVjdGlvbixcclxuICAgIGNoZWNrVXNhZ2VMaW1pdCxcclxuICAgIFxyXG4gICAgLy8gU21hcnQgcmVjb21tZW5kYXRpb25zXHJcbiAgICBnZXRVcGdyYWRlUmVjb21tZW5kYXRpb24sXHJcbiAgICBnZXRMb2NrZWRGZWF0dXJlcyxcclxuICAgIFxyXG4gICAgLy8gVXRpbGl0eSBtZXRob2RzXHJcbiAgICBnZXRBdmFpbGFibGVGZWF0dXJlcyxcclxuICAgIGdldFVzYWdlU3VtbWFyeSxcclxuICAgIGZvcm1hdEZlYXR1cmVNZXNzYWdlLFxyXG4gICAgXHJcbiAgICAvLyBGZWF0dXJlIGFjY2VzcyBzaG9ydGN1dHNcclxuICAgIGZlYXR1cmVBY2Nlc3MsXHJcbiAgICBcclxuICAgIC8vIEN1cnJlbnQgdXNhZ2VcclxuICAgIGN1cnJlbnRVc2FnZVxyXG4gIH0pLCBbXHJcbiAgICBzdWJzY3JpcHRpb25QbGFuLFxyXG4gICAgdGllcixcclxuICAgIGlzTG9hZGVkLFxyXG4gICAgY2FuQWNjZXNzRmVhdHVyZSxcclxuICAgIGhhc0ZlYXR1cmUsXHJcbiAgICBjaGVja011bHRpcGxlRmVhdHVyZXMsXHJcbiAgICBjYW5DcmVhdGVBdmF0YXIsXHJcbiAgICBjYW5DcmVhdGVDb2xsZWN0aW9uLFxyXG4gICAgY2hlY2tVc2FnZUxpbWl0LFxyXG4gICAgZ2V0VXBncmFkZVJlY29tbWVuZGF0aW9uLFxyXG4gICAgZ2V0TG9ja2VkRmVhdHVyZXMsXHJcbiAgICBnZXRBdmFpbGFibGVGZWF0dXJlcyxcclxuICAgIGdldFVzYWdlU3VtbWFyeSxcclxuICAgIGZvcm1hdEZlYXR1cmVNZXNzYWdlLFxyXG4gICAgZmVhdHVyZUFjY2VzcyxcclxuICAgIGN1cnJlbnRVc2FnZVxyXG4gIF0pO1xyXG59XHJcblxyXG4vKipcclxuICogSG9vayBmb3Igc3Vic2NyaXB0aW9uLXNwZWNpZmljIHVzYWdlIHRyYWNraW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdXNlVXNhZ2VUcmFja2luZygpIHtcclxuICBjb25zdCB7IHN1YnNjcmlwdGlvblBsYW4sIGN1cnJlbnRVc2FnZSB9ID0gdXNlU3Vic2NyaXB0aW9uKCk7XHJcbiAgXHJcbiAgY29uc3QgdHJhY2tVc2FnZSA9IHVzZUNhbGxiYWNrKGFzeW5jIChcclxuICAgIGFjdGlvbjogJ2F2YXRhcl9jcmVhdGVkJyB8ICdjb2xsZWN0aW9uX2NyZWF0ZWQnIHwgJ3Nlc3Npb25fc3RhcnRlZCcsXHJcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+XHJcbiAgKSA9PiB7XHJcbiAgICAvLyBBbmFseXRpY3MgdHJhY2tpbmcgZm9yIHN1YnNjcmlwdGlvbiB1c2FnZVxyXG4gICAgbG9nZ2VyLmluZm8oJ1N1YnNjcmlwdGlvbiB1c2FnZSB0cmFja2VkOicsIHtcclxuICAgICAgYWN0aW9uLFxyXG4gICAgICB0aWVyOiBzdWJzY3JpcHRpb25QbGFuPy50aWVyLFxyXG4gICAgICBjdXJyZW50QXZhdGFyczogY3VycmVudFVzYWdlLmF2YXRhcnNDb3VudCxcclxuICAgICAgbWV0YWRhdGFcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBIZXJlIHdlIGNvdWxkIHNlbmQgdG8gYW5hbHl0aWNzIHNlcnZpY2Ugb3IgZXh0ZXJuYWwgdHJhY2tpbmdcclxuICB9LCBbc3Vic2NyaXB0aW9uUGxhbiwgY3VycmVudFVzYWdlXSk7XHJcbiAgXHJcbiAgcmV0dXJuIHsgdHJhY2tVc2FnZSB9O1xyXG59ICJdLCJuYW1lcyI6WyJ1c2VTdWJzY3JpcHRpb24iLCJ1c2VVc2FnZVRyYWNraW5nIiwib3JnIiwiYXZhdGFycyIsImxvYWRpbmdTdGF0ZSIsInVzZVVzZXIiLCJzdWJzY3JpcHRpb25QbGFuIiwidXNlTWVtbyIsInRpZXIiLCJpc0xvYWRlZCIsImlzUmVhZHkiLCJjdXJyZW50VXNhZ2UiLCJhdmF0YXJzQ291bnQiLCJsZW5ndGgiLCJpc0xvYWRpbmdVc2FnZSIsImNhbkFjY2Vzc0ZlYXR1cmUiLCJ1c2VDYWxsYmFjayIsImZlYXR1cmUiLCJhbGxvd2VkIiwicmVhc29uIiwiU3Vic2NyaXB0aW9uU2VydmljZSIsImhhc0ZlYXR1cmUiLCJyZXN1bHQiLCJjaGVja011bHRpcGxlRmVhdHVyZXMiLCJmZWF0dXJlcyIsInJlZHVjZSIsImFjYyIsImNhbkNyZWF0ZUF2YXRhciIsImxvZ2dlciIsImluZm8iLCJjdXJyZW50Q291bnQiLCJsaW1pdCIsImNhbkNyZWF0ZUNvbGxlY3Rpb24iLCJlc3RpbWF0ZWRDb2xsZWN0aW9uc0NvdW50IiwiY2hlY2tVc2FnZUxpbWl0IiwibGltaXRUeXBlIiwiZ2V0VXBncmFkZVJlY29tbWVuZGF0aW9uIiwibG9ja2VkRmVhdHVyZXNBY2Nlc3NlZCIsInJlY29tbWVuZGVkIiwidGFyZ2V0VGllciIsInJlYXNvbnMiLCJiZW5lZml0cyIsInVyZ2VuY3kiLCJ1c2FnZURhdGEiLCJjb2xsZWN0aW9uc0NvdW50Iiwic2Vzc2lvbnNUaGlzTW9udGgiLCJkYXRhUmV0ZW50aW9uTW9udGhzIiwiZ2V0U21hcnRVcGdyYWRlUmVjb21tZW5kYXRpb24iLCJnZXRMb2NrZWRGZWF0dXJlcyIsImdldEF2YWlsYWJsZUZlYXR1cmVzIiwiZ2V0VXNhZ2VTdW1tYXJ5IiwiZm9ybWF0RmVhdHVyZU1lc3NhZ2UiLCJmb3JtYXRGZWF0dXJlR2F0ZU1lc3NhZ2UiLCJmZWF0dXJlQWNjZXNzIiwiZGFzaGJvYXJkIiwidXNlck1hbmFnZW1lbnQiLCJwcmVtaXVtVGhlbWVzIiwiY3VzdG9tQnJhbmRpbmciLCJjb2xsZWN0aW9ucyIsInNjaGVkdWxpbmciLCJidWxrT3BlcmF0aW9ucyIsImFwaUFjY2VzcyIsImV4cG9ydERhdGEiLCJhZHZhbmNlZFJlcG9ydGluZyIsInRyYWNrVXNhZ2UiLCJhY3Rpb24iLCJtZXRhZGF0YSIsImN1cnJlbnRBdmF0YXJzIl0sIm1hcHBpbmdzIjoiQUFBQTs7O0NBR0M7Ozs7Ozs7Ozs7O0lBZ0ZlQSxlQUFlO2VBQWZBOztJQTBOQUMsZ0JBQWdCO2VBQWhCQTs7O3VCQXhTcUI7NkJBQ2I7cUNBUWpCO3dCQUVnQjtBQW1FaEIsU0FBU0Q7SUFDZCxNQUFNLEVBQUVFLEdBQUcsRUFBRUMsT0FBTyxFQUFFQyxZQUFZLEVBQUUsR0FBR0MsSUFBQUEsb0JBQU87SUFFOUMseURBQXlEO0lBQ3pELE1BQU1DLG1CQUFtQkMsSUFBQUEsY0FBTyxFQUFDLElBQU1MLEtBQUtJLG9CQUFvQixNQUFNO1FBQUNKLEtBQUtJO0tBQWlCO0lBQzdGLE1BQU1FLE9BQU9ELElBQUFBLGNBQU8sRUFBQyxJQUFNRCxrQkFBa0JFLFFBQVEsTUFBTTtRQUFDRixrQkFBa0JFO0tBQUs7SUFDbkYsTUFBTUMsV0FBV0YsSUFBQUEsY0FBTyxFQUFDLElBQU1ILGFBQWFNLE9BQU8sRUFBRTtRQUFDTixhQUFhTSxPQUFPO0tBQUM7SUFF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